脚本（script）就是包含一系列命令的一个文本文件。Shell 读取这个文件，依次执行里面的所有命令，就好像这些命令直接输入到命令行一样。所有能够在命令行完成的任务，都能够用脚本完成。



脚本的好处是可以重复使用，也可以指定在特定场合自动调用，比如系统启动或关闭时自动执行脚本。



脚本的第一行通常是指定解释器，即这个脚本必须通过什么解释器执行。这一行以`#!`字符开头，这个字符称为 Shebang，所以这一行就叫做 Shebang 行。

`#!`后面就是脚本解释器的位置，Bash 脚本的解释器一般是`/bin/sh`或`/bin/bash`。

如 ：

```shell
#!/bin/sh
# 或者
#!/bin/bash
```

Shebang 行不是必需的，但是建议加上这行。如果缺少该行，就需要手动将脚本传给解释器。举例来说，脚本是`script.sh`，有 Shebang 行的时候，可以直接调用执行。

```shell
./script.sh
```

如果没有 Shebang 行，就只能手动将脚本传给解释器来执行。

```shell
$ /bin/sh ./script.sh
# 或者
$ bash ./script.sh
```

* 赋予脚本执行 权限

  ```shell
  # 给所有用户执行权限
  $ chmod +x script.sh
  
  # 给所有用户读权限和执行权限
  $ chmod +rx script.sh
  # 或者
  $ chmod 755 script.sh
  
  # 只给脚本拥有者读权限和执行权限
  $ chmod u+rx script.sh
  ```

建议在主目录新建一个`~/bin`子目录，专门存放可执行脚本，然后把`~/bin`加入`$PATH`。

```shell
export PATH=$PATH:~/bin
```

上面命令改变环境变量`$PATH`，将`~/bin`添加到`$PATH`的末尾。可以将这一行加到`~/.bashrc`文件里面，然后重新加载一次`.bashrc`，这个配置就可以生效了。

```shell
source ~/.bashrc
```

以后不管在什么目录，直接输入脚本文件名，脚本就会执行。

```shell
script.sh
```

Bash 脚本中，`#`表示注释，可以放在行首，也可以放在行尾。

* 脚本参数

调用脚本的时候，脚本文件名后面可以带有参数。

```shell
script.sh word1 word2 word3
```

上面例子中，`script.sh`是一个脚本文件，`word1`、`word2`和`word3`是三个参数。脚本文件内部，可以使用特殊变量，引用这些参数。

- `$0`：脚本文件名，即`script.sh`。
- `$1`~`$9`：对应脚本的第一个参数到第九个参数。
- `$#`：参数的总数。
- `$@`：全部的参数，参数之间使用空格分隔。
- `$*`：全部的参数，参数之间使用变量`$IFS`值的第一个字符分隔，默认为空格，但是可以自定义。

如果脚本的参数多于9个，那么第10个参数可以用`${10}`的形式引用，以此类推。

注意，如果命令是`command -o foo bar`，那么`-o`是`$1`，`foo`是`$2`，`bar`是`$3`。

```shell
#!/bin/bash
# script.sh

echo "全部参数：" $@
echo "命令行参数数量：" $#
echo '$0 = ' $0
echo '$1 = ' $1
echo '$2 = ' $2
echo '$3 = ' $3

# 全部参数：a b c
# 命令行参数数量：3
# $0 =  script.sh
# $1 =  a
# $2 =  b
# $3 =  c
```

用户可以输入任意数量的参数，利用`for`循环，可以读取每一个参数。

```shell
#!/bin/bash

for i in "$@"; do
  echo $i
done
```

上面例子中，`$@`返回一个全部参数的列表，然后使用`for`循环遍历。

如果多个参数放在双引号里面，视为一个参数。

```shell
./script.sh "a b"
```

上面例子中，Bash 会认为`"a b"`是一个参数，`$1`会返回`a b`。注意，返回时不包括双引号。

* `exit`命令用于终止当前脚本的执行，并向 Shell 返回一个退出值。 

命令后面可以跟参数，该参数就是退出状态

```shell
# 退出值为0（成功）
$ exit 0

# 退出值为1（失败）
$ exit 1
```

退出时，脚本会返回一个退出值。脚本的退出值，`0`表示正常，`1`表示发生错误，`2`表示用法不对，`126`表示不是可执行脚本，`127`表示命令没有发现。如果脚本被信号`N`终止，则退出值为`128 + N`。简单来说，只要退出值非0，就认为执行出错。

* alias: 命令用来为一个命令指定别名，这样更便于记忆。下面是`alias`的格式。

```shell
alias NAME=DEFINITION
```

上面命令中，`NAME`是别名的名称，`DEFINITION`是别名对应的原始命令。注意，等号两侧不能有空格，否则会报错。

`alias`也可以用来为长命令指定一个更短的别名。下面是通过别名定义一个`today`的命令。

```shell
$ alias today='date +"%A, %B %-d, %Y"'
$ today
# 星期一, 一月 6, 2020
```

有时为了防止误删除文件，可以指定`rm`命令的别名。

```shell
alias rm='rm -i'
```












!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.dmmma?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).tracertUtil={})}(this,(function(t){"use strict";function e(t,e,n){var r=3>=arguments.length||void 0===arguments[3]||arguments[3];if(t){var o=e||window.document;o.addEventListener?o.addEventListener(t,n,r):o.attachEvent?o.attachEvent("on".concat(t),n):o[t]=n}}function n(t,e,n){var r=3>=arguments.length||void 0===arguments[3]||arguments[3];if(t){var o=e||window.document;o.removeEventListener?o.removeEventListener(t,n,r):o.detachEvent?o.detachEvent("on".concat(t),n):o[t]=n}}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;arguments.length>e;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;e.length>n;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t){return function(t){if(Array.isArray(t))return d(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);e>n;n++)r[n]=t[n];return r}function p(t){"interactive"===document.readyState||"complete"===document.readyState?t():e("DOMContentLoaded",document,t)}function f(t){return"requestIdleCallback"in window?f(t):setTimeout(t)}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n={};for(var r in t)if(t.hasOwnProperty(r)){var o=0===r.indexOf(e)?r:e+r;n[o]=t[r]}return n}function h(t,e){var n=t||{};for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(n[r]=e[r]);return n}function v(t,e){var n="";try{n=RegExp("(?=\\?|\\&|\\b|^)".concat(t,"\\=(.+?)(?=\\&|$)")).exec(e),n=decodeURIComponent(n=n?"".concat(n[1]):"")}catch(t){console.warn(t)}return n}function g(t){var e=window.AlipayJSBridge;return e&&e.startupParams&&e.startupParams[t]}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:location.search;if(!t)return"";var n="";return""===(n=v(t,e))&&(n=g(t)),n}function w(t){var e=t||window.navigator.userAgent;if(!RegExp("aliapp\\(".concat("ap"),"i").test(e))return 0;var n=/alipayclient\/(\d+)\.?(\d+)?\.?(\d+)?/i.exec(e),r=0;if(n){var o=n[1]||0,a=n[2]||0,i=n[3]||0;10>+a&&(a="0".concat(a)),10>+i&&(i="0".concat(i)),r=parseFloat("".concat(o,".").concat(a).concat(i))}return r}var b="_TRACERT_COOKIE_";function D(t){console&&console.warn&&console.warn("Tracert deprecated：".concat(t))}function A(t,e,n){var r=void 0,o=void 0;try{return"function"==typeof e?o=e:r=e,void 0!==n&&(r=n),JSON.parse(t,o)}catch(t){return r}}function S(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",r=[];if(t instanceof Array)r=t;else if(t instanceof Object)for(e in t)t.hasOwnProperty(e)&&r.push("".concat(e,"=").concat(t[e]));return r.join(n)}function E(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^";if("string"!=typeof t)return null;var n=t.split(e);if(-1===t.indexOf("="))return n;for(var r,o=n.length,a={},i=0;o>i;i++)if(r=n[i]){var c=r.indexOf("=");if(c>0){var s=r.substring(0,c),u=r.substr(c+1)||"";a[s]=u}}return a||{}}function x(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,"".concat(t.getFullYear()).substr(4-RegExp.$1.length))),n)RegExp("(".concat(r,")")).test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?n[r]:"00".concat(n[r]).substr("".concat(n[r]).length)));return e}function O(t){return t?encodeURIComponent(t).replace(/'/g,"%27"):t}function T(t){return t?decodeURIComponent(t):""}var _=h,P=S;var C="data-aspm",j="data-aspm-click",L=["A","AREA"];function M(t){var e,n;try{return e=[].slice.call(t)}catch(o){e=[],n=t.length;for(var r=0;n>r;r++)e.push(t[r]);return e}}function I(){return window.performance&&window.performance.timing?!!window.performance.timing.loadEventEnd:"complete"===window.document.readyState}function B(t,e){return t&&t.getAttribute&&t.getAttribute(e)||""}function k(t){return null!==t&&"object"===a(t)&&1===t.nodeType}function N(t){return!(!t||!k(t)||t===document.body||t===document.documentElement)}function R(t){var e=t;if(!N(e))return"";for(var n="";e&&e!==document.body&&!(n=B(e,C));)e=e.parentNode;return n}function U(t){var e=t;if(!N(e))return"null";do{if(L.includes(e.tagName)||e.hasAttribute(j))return e}while((e=e.parentNode)&&e&&e.tagName&&"BODY"!==e.tagName&&e!==document.body&&!B(e,C));return null}function q(t){var e=t;if(!N(e))return"";if(L.includes(e.tagName)||e.hasAttribute(j)||(e=U(e)),!e)return"";var n=B(e,j),r=e.tagName;if(("string"==typeof n||L.includes(r))&&!n){var o=0,a=e;do{k(a)&&r===a.tagName&&o++,a=a.previousSibling}while(a);n=o}return"".concat(n)}function z(t){return E(t&&t.getAttribute?t.getAttribute("data-aspm-param"):"")||{}}function F(t){if(!t||!t.hasAttribute)return{};if(!t.hasAttribute("data-aspm-content"))return{};var e=t.getAttribute("data-anewChinfo")||"",n=t.getAttribute("data-new-ascm")||"",r=t.getAttribute("data-ascm")||n;return{param5:"newChinfo=".concat(e,"^scm=").concat(r),newScm:n}}function H(t,e){var n=e||t.getBoundingClientRect(),r=document.documentElement.clientHeight,o=Math.min(r,Math.max(n.top,0));return(Math.max(0,Math.min(n.top+n.height,r))-o)/n.height||1}function V(t){if(!t)return"";for(var e=[];t&&1===t.nodeType;){for(var n=1,r=t.previousSibling;r;)r.localName===t.localName&&n++,r=r.previousSibling;e.unshift("".concat(t.localName.toLowerCase(),"[").concat(n,"]")),t=t.parentNode}return e.length?"/".concat(e.join("/")):""}function J(t){if(!t||!t.getBoundingClientRect)return 0;if(0>=t.clientHeight||0>=t.clientWidth)return 0;var e=t.getBoundingClientRect(),n=e.left,r=e.top,o=e.right,a=e.bottom,i=window,c=i.innerHeight,s=i.innerWidth;if(0>a||r>c||0>o||n>s)return 0;var u=Math.max(0,r),l=Math.max(0,n),d=Math.min(c,a);return Math.floor((Math.min(s,o)-l)*(d-u)/((o-n)*(a-r))*100)}function G(t){return t&&t.tagName&&"string"==typeof t.tagName?t.tagName:""}function W(){return x(new Date,"yyyy-MM-dd hh:mm:ss.S")}function X(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.role_id||t.roleId||t.backupUserId||t.bucUserId||"";return O(e)}var K="180020010000000339";function $(t,e){console&&console.warn&&console.warn("[Tracker]",t);var n=e.v,r=void 0===n?"":n,o=e.spmAPos,a=void 0===o?"":o,i=e.spmBPos,c=void 0===i?"":i,s=Z(e);ot({yuyan_id:K,code:11,msg:et(t),d1:tt(t),d2:nt(t),d3:r,d4:s,d5:Q(),d6:g("appId"),full_url:rt(),spm:s,spma:a,spmb:c},e)}function Y(){return navigator&&navigator.userAgent?O(navigator.userAgent.replace(/,/g,"-")):""}function Q(){return navigator&&navigator.connection&&navigator.connection.effectiveType?O(navigator.connection.effectiveType):""}function Z(t){if(!t)return"";var e=t.spmAPos||"",n=t.spmBPos||"";return e&&n?O("".concat(e,".").concat(n)):""}function tt(t){return t?O(t.name||""):""}function et(t){return t?O(t.message||""):""}function nt(t){var e=t.stack,n=t.message,r=t.name,o=void 0===r?"":r,a=(void 0===e?"":e).replace(void 0===n?"":n,"");return(a=a.replace(o,""))&&a.length&&a.length>250&&(a=a.slice(0,250)),O(a)}function rt(){return location?O(location&&location.href||""):""}function ot(t,e){at()&&function(t){var e="https://mdap.alipay.com/loggw/dwcookieLogGet.do";try{var n=at();n.open("POST",e,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send("data=".concat(t,"&time=").concat((new Date).getTime()))}catch(n){try{(new Image).src="".concat(e,"?data=").concat(t,"&time=").concat((new Date).getTime())}catch(t){console&&console.warn&&console.warn("[Tracker]",t)}}}(["D-AE",W(),"","","2","","",X(e),"1000","102023","bmmonitor","2",Z(e),"","","","","","","","","","","","","","","","",Y(),"","","","","","",Object.keys(t).map((function(e){return"".concat(O(e),"=").concat(O(t[e]))})).join("^")])}function at(){var t=null;try{t=new XMLHttpRequest}catch(e){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}}}return t}function it(t){var e={is:!1,name:"",version:""};try{var n=t.match(/AliApp\S+\b\)/gi);e.is=/(T-UA)|(TBIOS)|(WindVane)|(AliApp)/i.test(t),e.name=n?n[0].match(/\(\w+-*\w*/)[0].split("(")[1]:"",e.version=n?n[0].match(/(\d+\.*)+/gi)[0]:""}catch(t){}return e}function ct(t){var e=function(t){return window?it(t=t||window.navigator.userAgent):{name:"non-browser"}}(t);return["AF","AFW","BK","AM","APHK","KB","Snail"].indexOf(e.name)>-1}var st={},ut="-1",lt=navigator&&navigator.userAgent||"",dt=navigator&&navigator.appVersion||"",pt=navigator&&navigator.vendor||"";function ft(t){return Object.prototype.toString.call(t)}var mt=[["wp",function(t){return-1!==t.indexOf("windows phone ")?/\bwindows phone (?:os )?([0-9.]+)/:-1!==t.indexOf("xblwp")?/\bxblwp([0-9.]+)/:-1!==t.indexOf("zunewp")?/\bzunewp([0-9.]+)/:"windows phone"}],["ios",function(t){return/\bcpu(?: iphone)? os /.test(t)?/\bcpu(?: iphone)? os ([0-9._]+)/:-1!==t.indexOf("iph os ")?/\biph os ([0-9_]+)/:/\bios\b/}],["yunos",/\baliyunos ([0-9.]+)/],["android",/\bandroid[\/\- ]?([0-9.x]+)?/],["linux","linux"]],ht=[["qq",/\bm?qqbrowser\/([0-9.]+)/],["ie",/\b(?:msie |ie |trident\/[0-9].*rv[ :])([0-9.]+)/],["chrome",/ (?:chrome|crios|crmo)\/([0-9.]+)/],["uc",function(t){return 0>t.indexOf("ucbrowser/")?/\buc\/[0-9]/.test(t)?/\buc\/([0-9.]+)/:0>t.indexOf("ucweb")?/\b(?:ucbrowser|uc)\b/:/\bucweb[\/]?([0-9.]+)?/:/\bucbrowser\/([0-9.]+)/}],["android",function(t){if(-1!==t.indexOf("android"))return/\bversion\/([0-9.]+(?: beta)?)/}],["safari",/\bversion\/([0-9.]+(?: beta)?)(?: mobile(?:\/[a-z0-9]+)?)? safari\//],["webview",/\bcpu(?: iphone)? os (?:[0-9._]+).+\bapplewebkit\b/]];function vt(t,e,n){var r="[object Function]"===ft(e)?e.call(null,n):e;if(!r)return null;var o={name:t,version:ut,codename:""};"android"===t&&(o.type=n.indexOf("Mobi")>-1?"phone":"pad"),"ios"===t&&(o.type=n.indexOf("iPhone")>-1?"phone":"pad");var a=ft(r);if(!0===r)return o;if("[object String]"===a){if(-1!==n.indexOf(r))return o}else{if(function(t){return"[object Object]"===ft(t)}(r))return r.hasOwnProperty("version")&&(o.version=r.version),o;if(r.exec){var i=r.exec(n);if(i)return o.version=i.length>=2&&i[1]?i[1].replace(/_/g,"."):ut,o}}}var gt={name:"na",version:ut};function yt(t,e,n,r){var o=gt;!function(t,e,n){for(var r=0,o=t.length;o>r&&!1!==e.call(t,t[r],r);r++);}(e,(function(e){var n=vt(e[0],e[1],t);if(n)return o=n,!1})),n.call(r,o.name,o.version)}var wt=function(t){t=(t||"").toLowerCase();var e={};return yt(t,mt,(function(t,n){var r=parseFloat(n);e.os={name:t,version:r,fullVersion:n},e.os[t]=r}),e),yt(t,ht,(function(t,n){var r=parseFloat(n);e.browser={name:t,version:r,fullVersion:n},e.browser[t]=r}),e),e};(st=wt("".concat(lt," ").concat(dt," ").concat(pt))).parse=wt,st._checkApp=it,st.app=st._checkApp(lt);var bt=st,Dt={},At={},St=null;var Et=(St||(St=new(function(){function t(){i(this,t)}return s(t,[{key:"getEventSequence",value:function(t,e){return At[e]||(At[e]={}),At[e]&&At[e][t]?++At[e][t]:At[e]?(At[e][t]=1,At[e][t]):(At[e]={},At[e][t]=1,At[e][t])}},{key:"getSequence",value:function(t){return Dt[t]?++Dt[t]:(Dt[t]=1,Dt[t])}}]),t}())),St),xt="__tracert_sequence",Ot="__tracert_sequence_id",Tt="__tracert_event_sequence",_t={http:"http",AlipayJSBridge:"AlipayJSBridge"};Object.freeze(_t);var Pt={autoClick:"autoClick",remoteLog:"remoteLog",pageMonitor:"pageMonitor",reportData:"reportData",semLog:"semLog",handleUEPEvent:"handleUEPEvent",reportUEPData:"reportUEPData"};function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=e,o=n.v,a=void 0===o?"":o,i=n._instanceId,c=void 0===i?"":i;return t===Pt.autoClick&&(r.param||(r.param={}),r.param.param4||(r.param.param4={}),r.param.param4=jt(r.param.param4,"autoClick",a,c)),t===Pt.remoteLog&&(r.param4||(r.param4=""),r.param4=jt(r.param4,r.actionId||"",a,c)),t===Pt.pageMonitor&&(r.param||(r.param={}),r.param=jt(r.param,"pageMonitor",a,c)),t===Pt.reportData&&(r.spmDetail||(r.spmDetail={}),r.spmDetail=jt(r.spmDetail,"reportData",a,c),r.spmDetail["".concat(Tt,"_pageMonitor")]=Et.getEventSequence("pageMonitor",c)),r}function jt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o="string"==typeof t,a=o?E(t):t;return a.sdkVersion=n,a[Ot]=r,a[xt]=Et.getSequence(r),a[Tt]=Et.getEventSequence(e,r),o?S(a):a}function Lt(t){var e=t.tracert,n=t.type,r=t.jsApiType,o=void 0===r?"remoteLog":r,a=t.errorHandler;if(!e)throw Error("request tracert");var i=t.data,c=void 0===i?{}:i,s=e.server,u=e.taskId,l=e.verifyServer;switch(e.debug&&console&&console.log&&console.log(c),n){case _t.http:try{c=function(t,e){var n=e.v,r=void 0===n?"":n,o=e._instanceId,a=t;if(a&&a.length){var i=a[0];"D-AE"===i&&(a[36]=jt(a[36],a[9],r,o)),"DW-COOKIE"===i&&(a[8]=jt(a[8],a[3],r,o))}return a}(c,e)}catch(t){$(t,e)}Mt(s,c,"",e),u&&l&&Mt(l,c,u,e);break;case _t.AlipayJSBridge:try{c=Ct(o,c,e)}catch(t){$(t,e)}Rt(c,o,e,a);break;default:Mt(s,c,u,e)}}function Mt(t,e,n,r){var o=r.openSendBeacon,a=void 0!==o&&o;if(t)if(!e||e.length&&0===e.length)$(Error("空数据"),r);else if(a&&Nt()){var i=It(e,n),c=new Blob([i],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(Bt(t,e,r).url,c)}else kt(t,e,n,r);else $(Error("请配置Tracert服务接收地址"),r)}function It(t,e){return e?"data=".concat(O(t.join()),"&time=").concat((new Date).getTime(),"&taskId=").concat(e):"data=".concat(O(t.join()),"&time=").concat((new Date).getTime())}function Bt(t,e,n){var r=n.bizType,o=n.spmAPos,a="",i=bt.os.name;if(i&&"na"!==i||(i="PC"),e&&e.length){var c=e[0];"D-AE"===c&&(a=e[9]),"DW-COOKIE"===c&&(a=e[3])}return{url:"https://collect.alipay.com/dwcookie"===t||"https://loggwpre.alipay.com/dwcookie"===t?"".concat(t,"?biztype=").concat(r,"&eventid=").concat(a,"&productid=").concat(i,"&spmAPos=").concat(o):t,bizType:r,eventid:a,productid:i}}function kt(t,e,n,r){var o=at();o&&(o.open("POST",Bt(t,e,r).url,!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.send(It(e,n)))}Object.freeze(Pt);function Nt(){return!!(navigator&&navigator.sendBeacon&&"function"==typeof navigator.sendBeacon&&Blob&&"function"==typeof Blob)}function Rt(t,e,n,r){try{window&&window.AlipayJSBridge?window.AlipayJSBridge.call(e,t,(function(o){[1,4].indexOf(o.error)>-1&&(r&&r(t,n),$(Error("".concat(e||""," no permission or no exist")),n))})):my&&my.canIUse(e)?my.call(e,t):$(Error("AlipayJSBridge and my is empty, ".concat(e||"")),n)}catch(e){r&&r(t,n),$(e,n)}}function Ut(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var qt="object"==typeof global&&global&&global.Object===Object&&global,zt="object"==typeof self&&self&&self.Object===Object&&self,Ft=qt||zt||Function("return this")(),Ht=function(){return Ft.Date.now()},Vt=/\s/;var Jt=/^\s+/;function Gt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Vt.test(t.charAt(e)););return e}(t)+1).replace(Jt,""):t}var Wt=Ft.Symbol,Xt=Object.prototype,Kt=Xt.hasOwnProperty,$t=Xt.toString,Yt=Wt?Wt.toStringTag:void 0;var Qt=Object.prototype.toString;var Zt=Wt?Wt.toStringTag:void 0;function te(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":Zt&&Zt in Object(t)?function(t){var e=Kt.call(t,Yt),n=t[Yt];try{t[Yt]=void 0;var r=!0}catch(t){}var o=$t.call(t);return r&&(e?t[Yt]=n:delete t[Yt]),o}(t):function(t){return Qt.call(t)}(t)}function ee(t){return null!=t&&"object"==typeof t}function ne(t){return"symbol"==typeof t||ee(t)&&"[object Symbol]"==te(t)}var re=/^[-+]0x[0-9a-f]+$/i,oe=/^0b[01]+$/i,ae=/^0o[0-7]+$/i,ie=parseInt;function ce(t){if("number"==typeof t)return t;if(ne(t))return NaN;if(Ut(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Ut(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Gt(t);var n=oe.test(t);return n||ae.test(t)?ie(t.slice(2),n?2:8):re.test(t)?NaN:+t}var se=Math.max,ue=Math.min;function le(t,e,n){var r,o,a,i,c,s,u=0,l=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var n=r,a=o;return r=o=void 0,u=e,i=t.apply(a,n)}function m(t){return u=t,c=setTimeout(v,e),l?f(t):i}function h(t){var n=t-s;return void 0===s||n>=e||0>n||d&&t-u>=a}function v(){var t=Ht();if(h(t))return g(t);c=setTimeout(v,function(t){var n=e-(t-s);return d?ue(n,a-(t-u)):n}(t))}function g(t){return c=void 0,p&&r?f(t):(r=o=void 0,i)}function y(){var t=Ht(),n=h(t);if(r=arguments,o=this,s=t,n){if(void 0===c)return m(s);if(d)return clearTimeout(c),c=setTimeout(v,e),f(s)}return void 0===c&&(c=setTimeout(v,e)),i}return e=ce(e)||0,Ut(n)&&(l=!!n.leading,a=(d="maxWait"in n)?se(ce(n.maxWait)||0,e):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==c&&clearTimeout(c),u=0,r=s=o=c=void 0},y.flush=function(){return void 0===c?i:g(Ht())},y}function de(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Ut(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),le(t,e,{leading:r,maxWait:e,trailing:o})}var pe={AUTO:"auto",MIX:"mix",MANUAL:"manual"},fe={CLICK:"clicked",EXPOSURE:"exposure",INPUT:"input",SCROLL:"scroll",TOUCH:"touch"},me=[fe.CLICK,fe.EXPOSURE,fe.INPUT,fe.SCROLL,fe.TOUCH],he=Object.freeze({__proto__:null,INPUT_TYPE:{NONE:"",TEXT:"text",SELECT:"select",TEXTAREA:"textarea",CHECKBOX:"checkbox",RADIO:"radio"},TAG_NAME:{INPUT:"INPUT",SELECT:"SELECT",TEXTAREA:"TEXTAREA",LABEL:"LABEL"},INPUT_ELEMENT_TYPES:{TEXT:"text",CHECKBOX:"checkbox",RADIO:"radio",PASSWORD:"password",URL:"url",EMAIL:"email",TEL:"tel",FILE:"file",SEARCH:"search",NUMBER:"number",DATETIME:"datetime",DATE:"date",MONTH:"month",WEEK:"week",DATETIME_LOCAL:"datetime-local",RANGE:"range"},COMBINE_TYPE:pe,EVENT_TYPE:fe,EVENT_TYPES:me,APP_TYPE:{AP:"alipay",TB:"taobao",FM:"idlefishx",TM:"tmall",QN:"qianniu",LX:"fliggy",KB:"koubei",AM:"koubeimerchant",AFW:"afwealth",ELMC:"elemec"}}),ve=1,ge="__uepElementId",ye=[],we=[];function be(t,e){Lt({tracert:e,type:_t.AlipayJSBridge,data:t,jsApiType:Pt.remoteLog})}function De(t,e){t.combineEventArray&&t.combineEventArray.forEach((function(n){delete n.uep,n.context=t.context,be(n,e)}))}function Ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.context;delete t.context,ct()?De(t,e):Lt({tracert:e,type:_t.AlipayJSBridge,data:t,jsApiType:Pt.handleUEPEvent,errorHandler:De})}function Se(){ye.length&&(Ae({eventArray:ye,context:this}),this.debug&&console.log("eventArray",ye),ye.length=0),we.length&&(Ae({combineEventArray:we,context:this}),this.debug&&console.log("combineEventArray",we),we.length=0)}var Ee=de(Se,500,{leading:!1});function xe(t){return t&&"string"!=typeof t?(t[ge]||(t[ge]="".concat(ve++)),t[ge]):""}function Oe(t){if("SELECT"===G(t)){var e=t.options[t.selectedIndex];return e&&e.textContent?e.textContent.trim().slice(0,20):""}if(t&&t.textContent){var n=t.textContent;return(void 0===n?"":n).trim().slice(0,20)}return""}function Te(t,e){switch(t.actionId){case"exposure":return function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).percent;return void 0===e&&(e=t?J(t):100),{state:e>0?"start":"end",percent:e}}(e,t);case"clicked":return function(t){if(!t)return null;var e,n=t.target||t.srcElement;return{text:Oe(n),xPos:~~t.pageX,yPos:~~t.pageY,innerWidth:window.innerWidth,clickable:(e=n,!e||!e.hasAttribute||!e.hasAttribute("disabled"))}}(e)}return t}function _e(t){var e=F(t);return e&&e.param5?e.newScm||E(e.param5).scm:""}function Pe(t,e){delete t.uep,Lt({tracert:e,type:_t.AlipayJSBridge,data:t,jsApiType:Pt.reportData})}function Ce(){for(var t=0,e={};arguments.length>t;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var je=function t(e){function n(t,r,o){var a;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=Ce({path:"/"},n.defaults,o)).expires){var i=new Date;i.setMilliseconds(i.getMilliseconds()+864e5*o.expires),o.expires=i}o.expires=o.expires?o.expires.toUTCString():"";try{a=JSON.stringify(r),/^[\{\[]/.test(a)&&(r=a)}catch(t){}r=e.write?e.write(r,t):encodeURIComponent(r+"").replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(t+"")).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var c="";for(var s in o)o[s]&&(c+="; "+s,!0!==o[s]&&(c+="="+o[s]));return document.cookie=t+"="+r+c}t||(a={});for(var u=document.cookie?document.cookie.split("; "):[],l=/(%[0-9A-Z]{2})+/g,d=0;u.length>d;d++){var p=u[d].split("="),f=p.slice(1).join("=");this.json||'"'!==f.charAt(0)||(f=f.slice(1,-1));try{var m=p[0].replace(l,decodeURIComponent);if(f=e.read?e.read(f,m):e(f,m)||f.replace(l,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(t){}if(t===m){a=f;break}t||(a[m]=f)}catch(t){}}return a}}return n.set=n,n.get=function(t){return n.call(n,t)},n.getJSON=function(){return n.apply({json:!0},[].slice.call(arguments))},n.defaults={},n.remove=function(t,e){n(t,"",Ce(e,{expires:-1}))},n.withConverter=t,n}((function(){}));function Le(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=window.localStorage&&window.localStorage.getItem(t)||je.get(t,e);if(je.get(t,e)&&window.localStorage)try{window.localStorage.setItem(t,n),je.remove(t,e)}catch(t){console&&console.warn&&console.warn("localstorage error")}return n}function Me(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||400>e.length||!n.cookie&&window.localStorage)if(window.localStorage)try{window.localStorage.setItem(t,e)}catch(r){je.set(t,e,n)}else je.set(t,e,n);else console&&console.warn&&console.warn("Tracert cookie set too long")}function Ie(t,e){window.localStorage&&window.localStorage.removeItem(t),je.remove(t,e)}var Be=new(function(){function t(){i(this,t)}return s(t,[{key:"set",value:function(){var t=[].slice.call(arguments);2>t.length?this._set(t):this._set(u({},t[0],t[1]),t[2]||{})}},{key:"get",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="".concat(b,"_").concat(t),o=Le(r,e);return n&&Ie(r),o}},{key:"_set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t&&0!==Object.keys(t).length)for(var n in t)if(t.hasOwnProperty(n)){var r="".concat(b,"_").concat(n);Me(r,t[n],e)}}}]),t}());var ke={parse:function(t){var e=t.split("//"),n=e[0],r=e[1]||"",o=r.split("/")[0],a=o.split(":"),i=a[0],c=a[1]||"",s=r.replace(o,"").split("#"),u=s[0],l=s[1]||"",d=l?"#".concat(l):null,p=u.split("?"),f=p[0],m=p[1]||"",h={protocol:n,slashes:!0,auth:null,host:o,port:c||null,hostname:i,hash:d,search:m?"?".concat(m):null,query:m||null,pathname:f,path:u,href:t,format:function(){return"".concat(h.protocol,"//").concat(h.host).concat(h.path).concat(h.hash||"")}};return h}},Ne=new(function(){function t(){i(this,t),this._iframe=null}return s(t,[{key:"initIframe",value:function(){if(this._iframe)return this._iframe;var t=document.createElement("iframe");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.left="-100px",t.style.bottom="-100px",t.style.width="-100px",t.setAttribute("src","https://tracert.alipay.com/cross.html"),t.onload=function(){t.style.display="none"};try{document.body.appendChild(t)}catch(t){}return this._iframe=t,t}}]),t}());var Re=Array.isArray,Ue=Wt?Wt.prototype:void 0,qe=Ue?Ue.toString:void 0;function ze(t){if("string"==typeof t)return t;if(Re(t))return function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}(t,ze)+"";if(ne(t))return qe?qe.call(t):"";var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}var Fe,He=Ft["__core-js_shared__"],Ve=(Fe=/[^.]+$/.exec(He&&He.keys&&He.keys.IE_PROTO||""))?"Symbol(src)_1."+Fe:"";var Je=Function.prototype.toString;var Ge=/^\[object .+?Constructor\]$/,We=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Xe(t){return!(!Ut(t)||(e=t,Ve&&Ve in e))&&(function(t){if(!Ut(t))return!1;var e=te(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}(t)?We:Ge).test(function(t){if(null!=t){try{return Je.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t));var e}function Ke(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Xe(n)?n:void 0}var $e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ye=/^\w*$/;var Qe=Ke(Object,"create");var Ze=Object.prototype.hasOwnProperty;var tn=Object.prototype.hasOwnProperty;function en(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function nn(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}en.prototype.clear=function(){this.__data__=Qe?Qe(null):{},this.size=0},en.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},en.prototype.get=function(t){var e=this.__data__;if(Qe){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Ze.call(e,t)?e[t]:void 0},en.prototype.has=function(t){var e=this.__data__;return Qe?void 0!==e[t]:tn.call(e,t)},en.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Qe&&void 0===e?"__lodash_hash_undefined__":e,this};var rn=Array.prototype.splice;function on(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}on.prototype.clear=function(){this.__data__=[],this.size=0},on.prototype.delete=function(t){var e=this.__data__,n=nn(e,t);return n>=0&&(n==e.length-1?e.pop():rn.call(e,n,1),--this.size,!0)},on.prototype.get=function(t){var e=this.__data__,n=nn(e,t);return 0>n?void 0:e[n][1]},on.prototype.has=function(t){return nn(this.__data__,t)>-1},on.prototype.set=function(t,e){var n=this.__data__,r=nn(n,t);return 0>r?(++this.size,n.push([t,e])):n[r][1]=e,this};var an=Ke(Ft,"Map");function cn(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function sn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}sn.prototype.clear=function(){this.size=0,this.__data__={hash:new en,map:new(an||on),string:new en}},sn.prototype.delete=function(t){var e=cn(this,t).delete(t);return this.size-=e?1:0,e},sn.prototype.get=function(t){return cn(this,t).get(t)},sn.prototype.has=function(t){return cn(this,t).has(t)},sn.prototype.set=function(t,e){var n=cn(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function un(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var i=t.apply(this,r);return n.cache=a.set(o,i)||a,i};return n.cache=new(un.Cache||sn),n}un.Cache=sn;var ln,dn,pn,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mn=/\\(\\)?/g,hn=(ln=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(fn,(function(t,n,r,o){e.push(r?o.replace(mn,"$1"):n||t)})),e},dn=un(ln,(function(t){return 500===pn.size&&pn.clear(),t})),pn=dn.cache,dn);function vn(t,e){return Re(t)?t:function(t,e){if(Re(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ne(t))||Ye.test(t)||!$e.test(t)||null!=e&&t in Object(e)}(t,e)?[t]:hn(function(t){return null==t?"":ze(t)}(t))}function gn(t){if("string"==typeof t||ne(t))return t;var e=t+"";return"0"==e&&1/t==-Infinity?"-0":e}function yn(t,e,n){var r=null==t?void 0:function(t,e){for(var n=0,r=(e=vn(e,t)).length;null!=t&&r>n;)t=t[gn(e[n++])];return n&&n==r?t:void 0}(t,e);return void 0===r?n:r}function wn(t){return function(t){return"number"==typeof t||ee(t)&&"[object Number]"==te(t)}(t)&&t!=+t}var bn=function(){function t(){var e=this;i(this,t),this.version="0.0.1",this.isMiniApp=!1,this.isInitSdk=!1,this.customDisplayList={},this.isVisDataMode="true",this.A="",this.B="",this.spmABList=[],this.initCount=0,this.insuranceTime=0,this.otherShowDataDomList=Object.create(null),this.showDataDomList=Object.create(null),this.oldShowDataDomList=!1,this.repeatPoint={},this.scrollTime=Date.now(),this.delayedInit=function(){e.start=!0,e.initSDK(),e.hashChangePage()},this.getAB=function(t){return e.A&&!t||(e.A=e.getA()||""),e.B&&!t||(e.B=e.getB()||""),e.A&&e.B?"".concat(e.A,".").concat(e.B):null},this.getB=function(){return B(document.body,C)||B(document.body,"data-aspm-b")},this.getA=function(){for(var t,e=M(document.getElementsByTagName("meta")),n=e.length,r=0;n>r;r++){var o=e[r],a=B(o,"name"),i=B(o,"content");switch(a){case C:case"data-aspm-a":t=i}if(t)break}return"a1877"===t||"a1180"===t?null:t},this.initSDK=function(){var t=e;t.getAB(!0)?t.changePage(!0):(t.initCount++,6>t.initCount&&setTimeout((function(){t.initSDK()}),666),console.warn("未能获取AB位"))},this.hashChangePage=function(){console.log("兼容容器预加载");var t=e;window.addEventListener("hashchange",(function(){var e=t.getA(),n=t.getB();t.A===e&&t.B===n||(t.initCount=0,t.initSDK())}))},this.changeAB=function(t,n){t&&n?(e.A=t,e.B=n):console.warn("a，b位不完整")},this.changePage=function(t){var n=e;n.startGetData.bind(e)(),t&&n.eventListener()},this.isminiAppDom=function(){document.getElementById("show_data_communication")?e.isMiniApp||(e.isMiniApp=!0,e.miniAppListener()):e.isMiniApp=!1},this.miniAppListener=function(){var t=e,n=document.getElementById("show_data_communication");if(n){var r=yn(n,"textContent");if(r)try{var o=JSON.parse(r);t.setSPMData(o)}catch(t){console.log(t)}new MutationObserver((function(){var e=n.textContent;if(e)try{var r=JSON.parse(e);t.setSPMData(r)}catch(t){console.log(t)}})).observe(n,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["textContent"]})}},this.eventListener=function(){if(!e.isInitSdk){e.isInitSdk=!0;var t=e;window.addEventListener("resize",(function(){t.throttleStartGetData()}),!0),window.addEventListener("touchstart",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),window.addEventListener("scroll",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),window.addEventListener("touchmove",(function(){t.scrollTime=Date.now(),t.scrollCompensate()}),!0),document.addEventListener("resume",(function(){t.getAB()&&t.changePage()}),!1);var n=document.body,r={attributes:!0,childList:!0,subtree:!0},o=new MutationObserver((function(e){var a=!1;e&&e.length&&e.length>0&&e.forEach((function(t){"BODY"!==t.target.nodeName&&"TracertWebShowData"!==t.target.id&&(a=!0)})),a&&(o.disconnect(),setTimeout((function(){o.observe(n,r)}),6),t.throttleStartGetData(),t.throttleisMiniAppDom())}));o.observe(n,r),window.requestAnimationFrame(t.idleGetData),t.dispatchReadyEvent()}},this.scrollCompensate=function(){1500>Date.now()-e.scrollTime&&(e.throttleStartGetData(),setTimeout((function(){e.scrollCompensate()}),6))},this.idleGetData=function(t){t||(t=0),setTimeout(t-e.insuranceTime>666?function(){e.insuranceTime=t,window.requestAnimationFrame(e.idleGetData)}:function(){e.throttleLangStartGetData(),e.insuranceTime=t,window.requestAnimationFrame(e.idleGetData)},666)},this.dispatchReadyEvent=function(){window.dispatchEvent(new Event("webShowDataReady"))},this.setSPMData=function(t){Ut(t)&&(e.customDisplayList=t||{},e.throttleStartGetData())},this.setSPMDataDom=function(){if("true"===e.isVisDataMode){var t=e.customDisplayList,n=Object.create(null);Object.keys(t).forEach((function(r){var o=t[r];if(!o.unShowCurrent){var a=e.getDomData("".concat(r),o);if(a){var i=e.addDom(a);i&&(n[a.name]=i)}}o.children&&Object.keys(o.children).forEach((function(t){var a=o.children[t],i=e.getDomData("".concat(r,".").concat(t),a);if(i){var c=e.addDom(i);c&&(n[i.name]=c)}}))})),e.otherShowDataDomList=n}},this.startGetData=function(){e.showDataDomList=Object.create(null),e.setSPMDataDom();var t=document.body;e.getData(t.children),e.setDataDom()},this.setDataDom=function(){"true"===e.isVisDataMode?(Object.assign(e.showDataDomList,e.otherShowDataDomList),e.oldShowDataDomList?e.changeShowDataDom():e.createShowDataDom()):e.delShowDataDom()},this.changeShowDataDom=function(){if("true"===e.isVisDataMode){e.setSPMDataDom();var t=document.querySelectorAll("#TracertWebShowData");if(t&&t.length>1)return e.delShowDataDom(),void e.createShowDataDom();var n=t[0];if(n&&n.children&&n.children.length>0){M(n.children).forEach((function(t){var r=t.getAttribute("data-showdataid"),o=e.showDataDomList[r];if(o){var a=o.width,i=o.height,c=o.top;t.style.transform="translate(".concat(o.left,"px, ").concat(c,"px)"),t.style.maxHeight="".concat(i,"px"),t.style.maxWidth="".concat(a,"px"),delete e.showDataDomList[r]}else n.removeChild(t)}));var r=Object.keys(e.showDataDomList);e.showDataDomList&&r.length>0&&r.forEach((function(t){n.appendChild(e.parseDom(e.showDataDomList[t].str))}))}else e.delShowDataDom(),e.createShowDataDom()}},this.createShowDataDom=function(){if("true"===e.isVisDataMode){e.setSPMDataDom();var t=document.createDocumentFragment(),n=document.createElement("div");n.id="TracertWebShowData";var r="";Object.keys(e.showDataDomList).forEach((function(t){r+=e.showDataDomList[t].str})),n.innerHTML=r,t.appendChild(n),document.getElementsByTagName("body")[0].appendChild(t),e.oldShowDataDomList=!0}},this.delShowDataDom=function(){var t=document.querySelectorAll("#TracertWebShowData");t&&t.length>0&&t.forEach((function(t){t&&t.children&&t.children.length>0?M(t.children).forEach((function(e){t.removeChild(e)})):document.body.removeChild(t)}))},this.getShowSpmCPos=function(t){var e=B(t,C)||B(t,"data-spmv")||"";return e?{spm:e}:(e=B(t,"data-aspm-c")||"")?{spm:e,type:"C"}:null},this.getShowSpmDPos=function(t){var e=B(t,"data-spmv")||B(t,j);return e?{spm:e}:(e=B(t,"data-aspm-d"))?{spm:e,type:"D"}:null},this.getRect=function(t){var e=t.getBoundingClientRect(),n=o({},JSON.parse(JSON.stringify(e))),r=window.getComputedStyle(t).zIndex;return n.zIndex=r="auto"===r?null:Number(r)+1,n},this.cName="",this.getData=function(t){"true"===e.isVisDataMode&&M(t).forEach((function(t){if(k(t)){var n=e.getRect(t);if(H(t,n)>0){var r=e.getShowSpmCPos(t);if(r){e.cName=r.spm;var o=e.getDomData("".concat(r.spm),n,r.type);if(o){var a=e.addDom(o);a&&(e.showDataDomList[o.name]?e.repeatPoint[o.name]=1+e.repeatPoint[o.name]||0:e.showDataDomList[o.name]=a)}}var i=e.getShowSpmDPos(t);if(i){var c=e.getDomData("".concat(e.cName,".").concat(i.spm),n,i.type);if(c){var s=e.addDom(c);s&&(e.showDataDomList[c.name]?e.repeatPoint[c.name]=1+e.repeatPoint[c.name]||0:e.showDataDomList[c.name]=s)}}t.children&&e.getData(t.children)}}}))},this.addDom=function(){},this.parseDom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes[0]},this.changeOthenAB=function(t){console.log("changeOthenAB",t)},this.addOtherAB=function(t,n){if(t!==e.A||n!==e.B){var r="".concat(t,".").concat(n);e.spmABList.includes(r)||(e.spmABList.push(r),e.changeOthenAB([r].concat(l(e.spmABList))))}},this.getSPMFullName=function(t,n){var r=null,o=null,a=null,i=null;if(t&&"string"==typeof t){var c=t.split("."),s=c.length;if(n)"C"===n&&(a=t),"D"===n&&("2">s?i=t:(i=c[s-1],a=c[s-2]));else{for(var u=s;u--;0>u){var l=c[u].substring(0,1);"a"===l&&(r||(r=c[u])),"b"===l&&(o||(o=c[u])),"c"===l&&(a||(a=c[u])),"d"===l&&(i||(i=c[u]))}var d=c[s-1];if(d){var p=Number(d);wn(p)||(i=p)}}}r&&o&&e.addOtherAB(r,o);var f=e.A,m=e.B;return f||(f=e.getA()),m||(m=e.getB()),i?{id:"".concat(r||f,".").concat(o||m,".").concat(a,".").concat(i),type:"D"}:{id:"".concat(r||f,".").concat(o||m,".").concat(a),type:"C"}},this.getDomData=function(t,n,r){var o=e.getSPMFullName(t,r);return{rect:n,name:o.id,type:o.type}},this.throttleStartGetData=de(this.startGetData,6),this.throttleLangStartGetData=de(this.startGetData,666),this.throttleisMiniAppDom=de(this.isminiAppDom,600)}return s(t,[{key:"start",value:function(){this.isVisDataMode="true",console.log("start"),I()?this.delayedInit():window.addEventListener("load",this.delayedInit)}},{key:"stop",value:function(){this.isVisDataMode="false",console.log("stop"),this.delShowDataDom()}}]),t}();t.Cookies=je,t.CrossIframe=Ne,t.ShowData=bn,t.YUYANID=K,t.addEvent=e,t.addMexOption=function(t,e){var n=t||{},r=e||{};if(!r.spmId||"mergeExpose"!==r.actionId)return n;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={},n[o]=_({},r))}return n},t.addSequence=jt,t.addToExObj=function(t,e){var n=t||{},r=e||{};if(!r.spmId||"mergeExpose"!==r.actionId)return null;if(3===r.spmId.split(".").length){var o=r.spmId;n[o]||(n[o]={});var a="";r.param4&&r.param4.rid?(a=r.param4.rid,delete r.param4.rid):a="",n[o][a]||(n[o][a]=[]),n[o][a].push(r.param4)}return n},t.config=he,t.cookiesPrefix=b,t.dealExtra=m,t.debounce=function(t,e){var n,r=arguments,o=this;return function(){var a=o,i=r;clearTimeout(n),n=setTimeout((function(){n=null,t.apply(a,i)}),e)}},t.decode=T,t.deprecated=D,t.detect=bt,t.encode=O,t.formatExObj=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],o=["fullURL","mBizScenario","mPageState","mPageName","version"];if("object"===a(t))for(var i in t)if(t.hasOwnProperty(i)){var c={};e?c=_(c,e[i]):(c.spmId=i,c.actionId="mergeExpose");var s=[];if(t[i].options)c.param4=P(t[i].options.param4);else{for(var u in t[i])if(t[i].hasOwnProperty(u)){for(var l=[],d=t[i][u],p=0;d.length>p;p++){var f=[],m=d[p];for(var h in m)m.hasOwnProperty(h)&&-1===o.indexOf(h)&&f.push("".concat(h,"|").concat(m[h]));l.push(f.join(";"))}s.push("rid|".concat(u,":").concat(l.join("&")))}c.param4="exposed=".concat(s.join("__"))}r.push({ExObj:c,currentConfig:n})}return r},t.getApFloatVersion=w,t.getAttr=B,t.getContentParam=F,t.getDPosDom=U,t.getDomConfig=function(t){return E(t&&t.getAttribute?t.getAttribute("data-aspm-config"):"")||{}},t.getDomExpoPercent=J,t.getDomParam=z,t.getHttpObj=at,t.getHttpSendUrl=Bt,t.getMetaPageName=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"pagename",e=M(window.document.getElementsByTagName("meta")),n="",r=0;e.length>r;r++){var o=e[r],a=B(o,"name"),i=B(o,"content");if(i&&a&&a===t){n=i;break}}return n},t.getMetaSpm=function(t){for(var e,n,r,o,a,i=M(t||document.getElementsByTagName("meta")),c=i.length,s=0;c>s;s++){switch(n=B(e=i[s],"name"),r=B(e,"content"),n){case C:a=r;break;case"data-bizType":o=r}if(a&&o)break}var u={};return a&&(u.spmAPos=a),o&&(u.bizType=o),u},t.getNetwork=Q,t.getNewDate=W,t.getPageMaxZindex=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=l(document.all).map((function(t){return+window.getComputedStyle(t).zIndex||0}));return e.length?Math.max.apply(Math,l(e)):t},t.getSendValue=It,t.getSpm=Z,t.getSpmBPos=function(){return B(document.body,C)},t.getSpmCPos=R,t.getSpmDPos=q,t.getTagName=G,t.getUA=Y,t.getUserId=X,t.getValue=y,t.getValueFromSearch=v,t.getValueFromStartupParams=g,t.getXPath=V,t.inIframe=function(){try{return window.self!==window.top}catch(t){return!0}},t.isDom=k,t.isLoaded=I,t.isViewDom=N,t.isWechat=function(){return"undefined"!=typeof WeixinJSBridge||"undefined"!=typeof QQJSBridge||!(!window.navigator||!(window.navigator.userAgent.toLowerCase().indexOf("micromessenger")>-1||window.navigator.userAgent.toLowerCase().indexOf("qq")>-1||window.navigator.userAgent.toLowerCase().indexOf("toutiaomicroapp")>-1||void 0!==window.navigator.wxuserAgent))},t.jsApiSendBefore=Ct,t.jsApiTypeEnum=Pt,t.jsonParse=A,t.load=p,t.log=function(t){var e=t.params,n=void 0===e?{}:e,r=t.context,a=t.currentConfig,i=void 0===a?{}:a,c=n.actionId,s=void 0===c?n.type:c,u=i.event,l=void 0===u?{}:u,d=i.combineType,p=i.bizType;if(-1!==me.indexOf(s)){var f;l.nodeName||l.nodeType?f=l:l.type&&(f=l.target||"");var m=n.param4?E(n.param4):null,h=o(o({},Te(n,l)),{},{type:s===fe.CLICK?"click":s,timestamp:n.eventTime,xpath:V(f),target:xe(f),spm:n.spmId,scm:n.newScm||n.scm,params:o({},m),bizCode:p||n.bizType,combineType:d||"manual",sdkParams:{sdkVersion:r.v}});delete n.newScm;var v=g("uepCombineMode");v||delete h.combineType,v&&d!==pe.AUTO?we.push(o(o({},n),{},{uep:h})):ye.push(h),Se.call(r)}else be(n,r)},t.logPv=function(t,e){ct()?Pe(t,e):Lt({tracert:e,type:_t.AlipayJSBridge,data:t,jsApiType:Pt.reportUEPData,errorHandler:Pe})},t.nodeListToArray=M,t.objToStr=S,t.objectAssign=h,t.ownAddEventListener=function(t,r,o){var a=3>=arguments.length||void 0===arguments[3]||arguments[3];return e(t,r,o,a),function(){n(t,r,o,a)}},t.processParam4=function(t){if("object"===a(t))for(var e in t)if(t.hasOwnProperty(e)&&"string"==typeof t[e]){var n=t[e].replace(/,/g,"%2C").replace(/\s+/g," ").replace(/=/g,"%3D");t[e]="fullURL"===e&&n.length>300?n.slice(0,300):n}return t},t.removeEvent=n,t.reportError=$,t.request=Lt,t.requestIdleCallback=f,t.requestTypeEnum=_t,t.sendAlipayJSBridge=Rt,t.sendHttpRequest=Mt,t.sendXhrGet=function(t,e,n){var r=at();r?(r.open("GET",t,!0),r.send(),r.onreadystatechange=function(){4===r.readyState&&(200!==r.status?n&&n(Error("request fail: status code "+r.status),r):e&&e(r.responseText,r))}):n&&n(Error("create xhr fail"))},t.sendXhrPost=kt,t.spmDPosMarkAttr=j,t.spmDataKey=C,t.spmExpoAttr="data-aspm-expo",t.spmExtParamAttr="data-aspm-param",t.spmVisualAttr="data-aspm-visual",t.storage=Be,t.strToObj=E,t.supportsSendBeacon=Nt,t.throttleLog=function(t){var e=t.params,n=t.event,r=t.context,a=t.combineType,i=n?n.target||n.srcElement||n:null,c=function(t,e){var n=q(t),r="";if(!e.spmAPos||!e.spmBPos||!n)return"";var o=n.split("."),a=!0;switch(o.length){case 1:o.unshift(R(t))}for(var i=0;2>i;i++)if(!o[i]){a=!1;break}return a&&(r=[e.spmAPos,e.spmBPos].concat(o).join(".")),r}(i,r),s=c&&z(i),u=o(o({timestamp:Date.now(),spm:c,scm:c&&_e(i),params:o({},s),combineType:a,xpath:V(i),target:xe(i)},e),{},{sdkParams:{sdkVersion:r.v}});g("uepCombineMode")||delete u.combineType,ye.push(u),Ee.call(r)},t.timeFormat=x,t.url=ke,t.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t.visibleProportion=H,t.yuyanLog=ot,Object.defineProperty(t,"__esModule",{value:!0})}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertCore=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;arguments.length>n;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){a(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){return function(e){if(Array.isArray(e))return e}(e)||l(e)||u(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e){return function(e){if(Array.isArray(e))return f(e)}(e)||l(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function u(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}function d(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var p="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,h=p||v||Function("return this")(),g=function(){return h.Date.now()},m=/\s/;var y=/^\s+/;function b(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&m.test(e.charAt(t)););return t}(e)+1).replace(y,""):e}var I=h.Symbol,_=Object.prototype,E=_.hasOwnProperty,j=_.toString,x=I?I.toStringTag:void 0;var O=Object.prototype.toString;var P=I?I.toStringTag:void 0;function k(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":P&&P in Object(e)?function(e){var t=E.call(e,x),n=e[x];try{e[x]=void 0;var i=!0}catch(e){}var r=j.call(e);return i&&(t?e[x]=n:delete e[x]),r}(e):function(e){return O.call(e)}(e)}var A=/^[-+]0x[0-9a-f]+$/i,S=/^0b[01]+$/i,w=/^0o[0-7]+$/i,T=parseInt;function C(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==k(e)}(e))return NaN;if(d(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=d(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=b(e);var n=S.test(e);return n||w.test(e)?T(e.slice(2),n?2:8):A.test(e)?NaN:+e}var L=Math.max,M=Math.min;function R(e,t,n){var i,r,o,a,s,c,l=0,u=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=i,o=r;return i=r=void 0,l=t,a=e.apply(o,n)}function h(e){return l=e,s=setTimeout(y,t),u?v(e):a}function m(e){var n=e-c;return void 0===c||n>=t||0>n||f&&e-l>=o}function y(){var e=g();if(m(e))return b(e);s=setTimeout(y,function(e){var n=t-(e-c);return f?M(n,o-(e-l)):n}(e))}function b(e){return s=void 0,p&&i?v(e):(i=r=void 0,a)}function I(){var e=g(),n=m(e);if(i=arguments,r=this,c=e,n){if(void 0===s)return h(c);if(f)return clearTimeout(s),s=setTimeout(y,t),v(c)}return void 0===s&&(s=setTimeout(y,t)),a}return t=C(t)||0,d(n)&&(u=!!n.leading,o=(f="maxWait"in n)?L(C(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),I.cancel=function(){void 0!==s&&clearTimeout(s),l=0,i=c=r=s=void 0},I.flush=function(){return void 0===s?a:b(g())},I}function B(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return d(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),R(e,t,{leading:i,maxWait:t,trailing:r})}var F=document,N=function(e){console&&console.warn&&console.warn("Tracert deprecated：".concat(e))};return function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var i={autoLogPv:!0,eventType:"click",autoExpo:!1,bizType:"H5behavior",state:"",name:"",logLevel:"2",mdata:{},seedIdPrefix:"",seedIdSuffix:"",spmAPos:"",spmBPos:"",bizScenario:e.getValue("bizScenario")||"",paramPrefix:"",debug:!1,server:"",taskId:"",verifyServer:"",lastClkSpm:"",url:location.href.split(/\?|#|;jsessionid=/)[0],referSPM:"",srcSpm:"",sessionIdKey:"tracert-session-key",seedIdCfg:{pageSeedId:"H5_MTRACKER_AP_PAGE",clkSeedId:"H5_MTRACKER_AP_CLK",calcSeedId:"H5_MTRACKER_AP_CALC",expoSeedId:"H5_MTRACKER_AP_EXPO",syslogSeedId:"H5_MTRACKER_AP_SYSLOG"},_plugins:[],platformType:"",ready:!1,apiCashList:[],timeMap:{},expoOnce:!1,_wap_intervalEx:400,_wap_interval:300,_wap_mgObjIndex:0,_wap_exObjIndex:0,_wap_mgTdObjIndex:0,_expoMergeItvObj:0,hasExpoMerge:!1,fmtedExObjArr:[],fmtedExObj:{},fmtedExOptions:{},cacheExObjArr:[],cacheMrExObjArr:[],expotTimeout:300,expoObj:{},expoType:function(t){return e.ownAddEventListener("scroll",F,B(t,300,{leading:!1,trailing:!0}))},expoSection:[-.3,.3],_beforeEvObj:{logPv:[],click:[],expo:[],set:[],send:[],autoClick:[],autoExpo:[]},_afterEvObj:{start:[],logPv:[],click:[],expo:[],set:[]},_sideEffects:[],_pluginLoadCnt:0,sysInfo:{},v:"",_instanceId:e.uuid()};e.objectAssign(i,n),e.objectAssign(this,i);var o=window.TracertCmdCache;if(o&&o.length)for(var a=0;o.length>a;a++){var l=[].slice.call(o[a]),u=s(l),f=u[0],d=u.slice(1);this.call.apply(this,[f].concat(c(d)))}this._start()}var a,l,u;return a=t,(l=[{key:"before",value:function(e,t){var n=this._beforeEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");n[e].push(t)}},{key:"_runBeforeFns",value:function(e,t){var n=this._beforeEvObj[e]||[];if(!n||!n.length)return!0;for(var i=0;n.length>i;i++)if(!1===n[i].call(this,t))return console&&console.debug&&console.debug("Tracert before fns: ".concat(e," stop propagation")),!1;return!0}},{key:"after",value:function(e,t){var n=this._afterEvObj;if(!n[e])throw Error("目标方法不支持该事件");if("function"!=typeof t)throw Error("监听器不是函数");"start"===e&&this.ready?t():n[e].push(t)}},{key:"_runAfterFns",value:function(e,t){var n=this._afterEvObj[e]||[];if(n&&n.length)for(var i=0;n.length>i;i++)n[i].call(this,t)}},{key:"init",value:function(){}},{key:"load",value:function(t){e.load(t)}},{key:"onReady",value:function(e){this.ready?e&&e():document.addEventListener("TracertOnReady",(function(){e&&e()}))}},{key:"_start",value:function(){var t=this,n=function(){t.load((function(){if(!t.ready){if(t.get("_isMain")){var n=e.getMetaSpm();n.spmAPos=t.spmAPos||n.spmAPos,t.spmBPos||(n.spmBPos=e.getSpmBPos()),t.set(n)}t.ready=!0;for(var i=0;t.apiCashList.length>i;i++)t.call.apply(t,t.apiCashList[i]);t._runAfterFns("start"),t.apiCashList=[]}}))};this.pluginReady&&this.started?n():(document.addEventListener("TracertPluginReady",(function(e){t.started&&t._instanceId===e._instanceId&&n()})),document.addEventListener("TracertStart",(function(e){t.pluginReady&&t._instanceId===e._instanceId&&n()})))}},{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.run(e)}},{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.set(n(n({},t),{},{started:!0}));var i=document.createEvent("HTMLEvents");i._isMain=!!this._isMain,i._instanceId=this._instanceId,i.initEvent("TracertStart",!0,!0),document.dispatchEvent(i),this.autoLogPv&&this.call("logPv",{combineType:e.config.COMBINE_TYPE.MIX})}},{key:"addSideEffects",value:function(){var e=[].slice.call(arguments);"function"==typeof e[0]&&(this._sideEffects.includes(e)||this._sideEffects.push(e))}},{key:"clearSideEffects",value:function(){if(!this._sideEffects||!this._sideEffects.length)return!0;for(var e=0;this._sideEffects.length>e;e++){var t=this._sideEffects[e],n=t.slice(1);t[0]&&t[0](n)}return!0}},{key:"loadPlugins",value:function(e){if(e&&e.length){this._plugins=e;for(var t=0;e.length>t;t++)this.loadPlugin(e[t])}}},{key:"loadPlugin",value:function(e){var t=this;e&&(window["tracert".concat(e)]&&"function"==typeof window["tracert".concat(e)]||"function"==typeof e)&&("function"==typeof e?e:window["tracert".concat(e)])(this,(function(){if(t._pluginLoadCnt++,t._pluginLoadCnt===t._plugins.length){t.set({pluginReady:!0});var e=document.createEvent("HTMLEvents");e._isMain=!!t._isMain,e._instanceId=t._instanceId,e.initEvent("TracertPluginReady",!0,!0),document.dispatchEvent(e)}}))}},{key:"call",value:function(){var e,t=[].slice.call(arguments);if(!t[0]||"run"!==t[0]&&"start"!==t[0]||this.set({started:!0}),this.ready){if(!this[t[0]]||"function"!=typeof this[t[0]])return console.warn("未找到方法：".concat(t[0])),null;var n=t.slice(1);n=this.optionsHandle(n),e=this[t[0]].apply(this,n)}else this.apiCashList.push(t);return e}},{key:"optionsHandle",value:function(e){return e&&e.length?(e.forEach((function(e){var t=e;t&&(t.spmid&&(t.spmId=t.spmid),t.seedid&&(t.seedId=t.seedid),t.ucid&&(t.ucId=t.ucid))})),e):e}},{key:"get",value:function(e){return this[e]}},{key:"set",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r;this._runBeforeFns("set",o),o.eventName&&e.objectAssign(o,{eventType:o.eventName}),"object"===i(o.mdata)&&(o.mdata=n(n({},this.mdata),o.mdata));for(var a={},s=Object.keys(o),c=0;s.length>c;c++){var l=s[c];o[l]instanceof Function?function(){var n=o[l];a[l]=function(){try{for(var i=arguments.length,r=Array(i),o=0;i>o;o++)r[o]=arguments[o];return n.apply(t,r)}catch(n){e.reportError(n,t)}}}():a[l]=o[l]}e.objectAssign(this,a),this._runAfterFns("set",o)}},{key:"getSysInfo",value:function(e){return this.sysInfo[e]}},{key:"setSysInfo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t;e.objectAssign(this.sysInfo,n)}},{key:"config",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N("config 已废弃！请使用 set 方法"),this.set(e)}},{key:"remoteLog",value:function(){}},{key:"logPv",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._runBeforeFns("logPv",e);t&&(this._logPv(e),this._runAfterFns("logPv",e))}},{key:"_logPv",value:function(){}},{key:"report",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.params,r=e.spmId;if(r){var o=r.split("."),a=o[0],s=o[1];a&&s&&this.set({spmAPos:a,spmBPos:s})}"object"===i(t)&&this.set({mdata:n(n({},this.mdata),t)}),this.set({_calledLogPv:!!r}),this.call("logPv")}},{key:"pageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.set({state:e}),this.call("logPv")}},{key:"pageName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";N("已废弃"),this.set({name:e})}},{key:"setPageState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.call("pageState",e)}},{key:"time",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;t&&!n[t]&&(n[t]=new Date-0)}},{key:"timeEnd",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t="".concat(e),n=this.timeMap;if(!t||!n[t])return"";var i=n[t],r=new Date-0-i;return delete n[t],r}},{key:"_goRemotelog",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.seedId||t.spmId){var n=t.spmId||t.spmid||"",r=n.split("."),o=r.length,a=this.spmAPos,s=this.spmBPos;if(a&&s)switch(o){case 1:case 2:if(""===n)break;if(0!==n.indexOf("c"))break;n=[a,s,n].join(".")}var c={ucId:t.ucId,seedId:t.seedId,spmId:n,actionId:t.actionId,logLevel:t.logLevel||this.logLevel,param4:t.mdata||{}};if(t.type&&(c.type=t.type),t.params&&"object"===i(t.params))if(t.params.length)e.objectAssign(c,{param1:t.params[0]||"",param2:t.params[1]||"",param3:t.params[2]||""});else{var l=t.mdata||{};e.objectAssign(l,t.params),e.objectAssign(c.param4,l)}if(t.timeKey){var u=this.call("timeEnd",t.timeKey);u&&(c.param4.consume=u)}this.call("remoteLog",c)}else console.warn("请填入埋点seedId或spmId")}},{key:"info",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._goRemotelog(e)}},{key:"error",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.objectAssign(t,{type:"error",actionId:"exception"}),this._goRemotelog(t)}},{key:"click",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=a;s.combineType=s.combineType?s.combineType:"manual";var c={spmId:i,extra:r,options:o,currentConfig:s},l=this._runBeforeFns("click",c);if(l){var u=r.extraSpmIds;c.extra.extraSpmIds&&delete c.extra.extraSpmIds;var f=c.spmId.split(":"),d=f[1]?{seedDesc:f[1]}:{};e.objectAssign(d,e.dealExtra(c.extra,this.paramPrefix));var p={param1:this.url,param2:f[0],param4:d,seedId:this.seedIdCfg.clkSeedId,actionId:e.config.EVENT_TYPE.CLICK,spmId:f[0]};if(this.fullLinkAndChInfo){var v=c.extra.newChinfo||"",h=c.extra.entityId||c.extra.scm||"";if(v&&h){var g={param5:"newChinfo=".concat(v,"^scm=").concat(h)};e.objectAssign(c.options,g)}}e.objectAssign(p,c.options),this.set({lastClkSpm:c.spmId}),this.call("remoteLog",n({},p),s),u&&u.length&&u.forEach((function(e){t.call("remoteLog",n(n({},p),{},{extraPageId:e}),s)})),this._runAfterFns("click",c)}}},{key:"expo",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=o;a.combineType=a.combineType?a.combineType:"manual";var s={spmId:t,offset:n,extra:i,options:r,currentConfig:a},c=this._runBeforeFns("expo",s);if(c){var l={param1:this.url,param2:s.spmId,param3:s.offset,param4:e.dealExtra(s.extra,this.paramPrefix),seedId:this.seedIdCfg.expoSeedId,actionId:e.config.EVENT_TYPE.EXPOSURE,spmId:s.spmId};if(this.fullLinkAndChInfo){var u=s.extra.newChinfo||"",f=s.extra.entityId||s.extra.scm||"";if(u&&f){var d={param5:"newChinfo=".concat(u,"^scm=").concat(f)};e.objectAssign(l,d),e.objectAssign(s.options,d)}}e.objectAssign(l,r);var p=r&&r.force;this.expoObj=this.expoObj||{},p||!1!==this.expoObj[s.spmId]?(this.expoOnce&&a.combineType!==e.config.COMBINE_TYPE.AUTO&&(this.expoObj[s.spmId]=!1),this.call("remoteLog",l,a),this._runAfterFns("expo",s)):console.warn("点位 ".concat(s.spmId," 已经曝光过了"))}}},{key:"calc",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};N("calc 已废弃");var r={param1:this.url,param2:t,param3:n,param4:e.dealExtra(i,this.paramPrefix),seedId:this.seedIdCfg.calcSeedId,actionId:"timestamp"};this.call("remoteLog",r)}},{key:"expoContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.expo(e,"up",i,{param5:"newChinfo=".concat(n,"^scm=").concat(t||r),newScm:r},o)}},{key:"clickContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.click(e,i,{param5:"newChinfo=".concat(n,"^scm=").concat(t||r),newScm:r},o)}}])&&o(a.prototype,l),u&&o(a,u),t}()}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t=t||self).tracertMonitor=e(t.tracertUtil)}(this,(function(util){"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(t){for(var e=1;arguments.length>e;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(r),!0).forEach((function(e){_defineProperty(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function _objectWithoutPropertiesLoose(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;i.length>n;n++)0>e.indexOf(r=i[n])&&(o[r]=t[r]);return o}function _objectWithoutProperties(t,e){if(null==t)return{};var r,n,o=_objectWithoutPropertiesLoose(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(n=0;i.length>n;n++)0>e.indexOf(r=i[n])&&Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}var version="0.1.37",errorCodeEnums={JS:1,REQUEST:2,PROMISEREJECTION:3,ASSETS:4};function getResourceErrorSrc(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.src||t.href;return"img"===t.tagName.toLowerCase()&&0===e.indexOf("data:")&&(e=e.split(",")[0]),e}function getTime(){var t=new Date,e=function(t){return 10>t?"0".concat(t):"".concat(t)};return"".concat(t.getFullYear(),"-").concat(e(t.getMonth()+1),"-").concat(e(t.getDate())," ").concat(e(t.getHours()),":").concat(e(t.getMinutes()),":").concat(e(t.getSeconds()),":").concat(t.getMilliseconds())}function getXPath(t,e){var r=t.id?"".concat(t.id):"",n=t.className?"".concat(t.className):"",o=t.tagName.toLowerCase(),i=r||n,a=[];r&&a.push('[@id="'.concat(r,'"]')),n&&a.push('[@class="'.concat(n,'"]'));var c="".concat(o).concat(i?a.join(""):"");return t.parentNode&&t.parentNode.tagName&&e-1!=0?"".concat(getXPath(t.parentNode,e-1),">").concat(c):c}function safelyPush(t,e,r){var n=r||20;if(!t||!e)return null;n>=r&&r||(r=n),t.push(e);var o=t.length-n;return o>0&&(t=t.slice(o)),t}function generateIdentifier(t){return[t.code,t.uid,t.page,t.msg||""].join("_")}function getUserId(t){return t&&(t.role_id||t.roleId||t.cUserId||t.backupUserId||t.bucUserId)||""}var objectAssign=util.objectAssign,doc=document,docEl=doc.documentElement,startTime=(new Date).getTime(),fieldLenLimt=660,limitFields=["code","msg"],encodeValue=function(t){return encodeURIComponent(t).replace(/'/g,"%27")};function objToStr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"^",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=[];if(t instanceof Array)o=t;else if(t instanceof Object){var i=n?encodeValue:function(t){return t};for(e in t)if(t.hasOwnProperty(e)){var a=i(t[e]);o.push("".concat(e,"=").concat(a))}}return o.join(r)}function initSessionId(t){if(!t.sessionId){var e=window.sessionStorage,r=t.sessionIdKey;e||(e={}),e[r]||(e[r]="".concat(util.uuid(),"_").concat(Date.now())),t.set({sessionId:e[r]})}}function getNetwork(){return navigator&&navigator.connection&&navigator.connection.effectiveType?navigator.connection.effectiveType:""}function filterParam(t,e){objectAssign(e,this.mdata||{}),e.title=document.title,e.dom_cnt=document.getElementsByTagName("*").length,e.delay=(new Date).getTime()-startTime,e.scroll_top=docEl.scrollTop+doc.body.scrollTop,e.content_height=Math.max(docEl.clientHeight,docEl.offsetHeight,docEl.scrollHeight),e.last_action=this._lastAction,e.monitorConfigFailed=this._monitorConfigFailed?1:0,e.network=getNetwork(),e.spmId=t;var r=this.refSpm||this.referSPM||"";e.ref=this.refUrl,e.referSPM=r,e.fullURL=this.fullURL||location.href,e.source_appid=this.spmAPos,this._spmId&&(e._spmId=this._spmId),this._refSpm&&(e._refSpm=this._refSpm),this.cOfflineVer&&(e.c_offline_ver=this.cOfflineVer),this.cAppId&&(e.c_app_id=this.cAppId);var n=[version],o=this._v;if(o&&n.push("h5:".concat(o)),e.tracert_ver=n.join(";"),"object"===_typeof(e)){var i=e;for(var a in i)if(i.hasOwnProperty(a)&&"string"==typeof i[a]){0>limitFields.indexOf(a)&&!/^[dmc]\d+$/.test(a)||i[a].length>fieldLenLimt&&(i[a]=i[a].slice(0,fieldLenLimt));var c=i[a].replace(/\s+/g," ");i[a]="fullURL"===a&&c.length>300?c.slice(0,300):c}}return e}function getUA(){return navigator.userAgent?navigator.userAgent.replace(/,/g,"%2C"):""}function packFinalData(t){var e=t.spmId,r=t.seedId,n=t.param4,o=n.__sid||this.sessionId||util.uuid();delete n.__sid;var i=new Date,a=function(t){return 10>t?"0".concat(t):"".concat(t)},c=getUserId(this),s=["D-AE","".concat(i.getFullYear(),"-").concat(a(i.getMonth()+1),"-").concat(a(i.getDate())," ").concat(a(i.getHours()),":").concat(a(i.getMinutes()),":").concat(a(i.getSeconds()),":").concat(i.getMilliseconds()),this.clientId,"","2","",o,c,1e3,r,"H5behavior",this.logLevel,"","","","","","","","","","","","","","".concat(window.innerWidth||"","x").concat(window.innerHeight,"x").concat(window.devicePixelRatio),"","","",getUA(),"","","",objToStr(this.sysInfo),"",""];if(1===n.s3&&1===n.code)s.push(objToStr(n,"^",!0));else{var d=filterParam.call(this,e,n);s.push(objToStr(d,"^",!0))}for(var l=0;s.length>l;l++)"string"==typeof s[l]&&(s[l]=s[l].replace(/,/g,"%2C"));return s}function sendData(t){var e=window.encodeURIComponent;this.debug&&console.log(t),this._httpLog(e(t.join()))}function bridgeLog(t){window.AlipayJSBridge?window.AlipayJSBridge.call("handleLoggingAction",{actionType:"reportEvent",params:{eventId:this.seedIdCfg.exceptionSeedId||this._defaultExceptionSeedId,bizType:"bmmonitor",extData:t||{}}}):this._warn("非容器环境，不能调用 handleLoggingAction")}function remoteLog(t){this.init(),initSessionId(this);var e=t.param4,r=t.spmId;if(window.AlipayJSBridge&&e&&e.code>10){var n=filterParam.call(this,r,e);for(var o in delete n.__sid,n._ua=getUA(),n.spmId=r,n)n.hasOwnProperty(o)&&"string"==typeof n[o]&&(n[o]=encodeValue(n[o]));bridgeLog.call(this,n)}else{var i=packFinalData.call(this,t);sendData.call(this,i)}}function log(t){try{var e=this._preproccess(t);if(!e)return;if(void 0!==e.sampleRate&&Math.random()>e.sampleRate)return void this._warn("当前已设置采样率 ".concat(e.sampleRate,"，未被采集"));this._runBeforeFns("send",e);var r=e.bmAppid||this._bmAppId;remoteLog.call(this,{spmId:this.spmAPos&&this.spmBPos?"".concat(this.spmAPos,".").concat(this.spmBPos):"",seedId:this.seedIdCfg.exceptionSeedId||this._defaultExceptionSeedId,param4:_objectSpread2({pid:this.pid||"",bm_appid:r,bm_sid:this._bmSprintId,env:this._env||""},e)})}catch(t){this._warn("Tracert 异常上报失败:",t)}}function getMonitorConfig(t){for(var e=null,r=0;this._monitorConfigs.length>r;r++)this._monitorConfigs[r].code===t.code&&(e=this._monitorConfigs[r]);return e}function filterOptions(t,e){for(var r={},n=0;e.fields.length>n;n++)r[e.fields[n]]=!0;for(var o in t)!r[o]&&/^[dmc]\d+$/.test(o)&&delete t[o];return t}function preproccess(t){if(!t)return!1;if(1===t.code&&1===t.s3)return t;if("function"==typeof this.beforeLog){var e;try{e=this.beforeLog(t)}catch(t){}if(!1===e)return this._warn("当前由于 beforeLog 返回 false，未被采集"),!1;"object"===_typeof(e)&&(t=e)}for(var r=generateIdentifier(_objectSpread2({},t,{uid:getUserId(this),page:this.fullURL||location.href})),n=!1,o=0;this._trackedLogs.length>o;o++)if(this._trackedLogs[o]===r){n=!0;break}if((null==t.oncePerSession?this.oncePerSession:t.oncePerSession)&&n)this._warn("当前由于 OncePerSession 策略，未被采集");else{if(this._monitorConfigInited||this._monitorConfigFailed){if(this._monitorConfigFailed)return t;if(void 0!==t.bmAppid&&this._bmAppId!==t.bmAppid)return t;var i=getMonitorConfig.call(this,t);return!!i&&(i.isDeleted||!i.isActive?(this._warn("当前监控项已关闭"),!1):(void 0===t.sampleRate&&(t.sampleRate=i.sampleRate),!n&&this._trackedLogs.push(r),filterOptions(t,i)))}safelyPush(this._cacheLogs,t)}}function handleErrorOptions(t,e){var r=t.target||t.srcElement;if(r)if("unhandledrejection"!==t.type){if(r instanceof HTMLElement){var n=getResourceErrorSrc(r),o=r.tagName.toLowerCase(),i=r.alt,a=void 0===i?"":i;e({code:errorCodeEnums.ASSETS,msg:n||"",s1:o,s2:getXPath(r,5),s3:a})}else t.error&&t.error.stack?this.logError(t.error):e({code:errorCodeEnums.JS,msg:t.message,s3:0})}else{var c=t.reason||{};if(c.message&&c.stack)this.logError(c,{code:errorCodeEnums.PROMISEREJECTION});else{var s=c.message||("string"==typeof c?c:JSON.stringify(c));e({code:errorCodeEnums.PROMISEREJECTION,msg:s})}}}function handleErrorOptions$1(t,e){try{handleErrorOptions.call(this,t,e)}catch(t){this._warn("handleErrorOptions failed",t)}}var win=window;function interfaceRegister(t){var e=!1;if("XMLHttpRequest"in win){var r=win.XMLHttpRequest.prototype,n=r.open;r.open=function(t,e){this.__tracertMonitor__={method:t,url:e||"",status_code:null};for(var r=Array(arguments.length),o=0;r.length>o;++o)r[o]=arguments[o];n.apply(this,r)};var o=r.send;r.send=function(r){var n=this;function i(){if(n.__tracertMonitor__&&4===n.readyState)try{var o=n.__tracertMonitor__.url;if(0===n.status)return;var i=o.split("?")[0],a=o.split("?")[1]||"",c="string"==typeof r?r:JSON.stringify(r),s=n.response+"";s.length>2048&&(s="[too large]");if(200>n.status||n.status>299||e){if(i===t.server)return void t._warn("Tracert 上报异常",c);t.logRequestError({type:"http",status:n.status,url:i,method:n.__tracertMonitor__.method,query:a,data:c,response:s,traceId:t.traceId||""})}}catch(e){t._warn("Tracert 接口异常上报失败:",e)}}if("onreadystatechange"in n&&"function"==typeof n.onreadystatechange){var a=n.onreadystatechange;n.onreadystatechange=function(){for(var t=Array(arguments.length),e=0;t.length>e;++e)t[e]=arguments[e];i.apply(this,t),a.apply(this,t)}}else n.onreadystatechange=i;for(var c=Array(arguments.length),s=0;c.length>s;++s)c[s]=arguments[s];return o.apply(this,arguments)}}if("fetch"in win){var i=win.fetch;win.fetch=function(){for(var r=Array(arguments.length),n=0;r.length>n;++n)r[n]=arguments[n];var o="GET";return r[1]&&r[1].method&&(o=r[1].method.toUpperCase()),i.apply(this,r).then((function(n){return new Promise((function(i){try{var a=r[0],c=a.split("?")[0],s=a.split("?")[1]||"",d=r[1]&&r[1].body||"",l="string"==typeof d?d:JSON.stringify(d);n.clone().text().then((function(r){n.ok&&!e||t.logRequestError({type:"http",status:n.status,url:c,method:o,query:s,data:l,response:(r||"").length>2048?"[too large]":r,traceId:t.traceId||""})})).then((function(){i(n)}),(function(t){i(n)}))}catch(t){i(n)}}))}))}}}function _typeof$1(t){return(_typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);t.length>e;e++)r[e]=t[e];return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _iterableToArrayLimit(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var checkEnv=function(){var t=window.navigator.userAgent,e="";return!!t.match(/iphone|ipad|iPod/gi)&&(e="iOS"),!!t.match(/android/gi)&&(e="Android"),!!t.match(/Firefox/gi)&&(e="Firefox"),!!t.match(/Chrome/gi)&&(e="Chrome"),!t.match(/Chrome/gi)&&!!t.match(/Safari/gi)&&(e="Safari"),!!t.match(/Opera/gi)&&(e="Opera"),!!t.match(/MSIE/gi)&&(e="IE"),e};function checkAndriodSpecial(){return!0}var generateHandler=function(t){switch(t){case"iOS":return{filter:function(t){return 0>t.indexOf("[native code]")&&t.indexOf("@")>=0}};case"Android":return{filter:function(t,e){return e&&0>t.indexOf("nonymous")&&checkAndriodSpecial()}};default:return{filter:function(){return!0}}}};function safeAdd(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function bitRotateLeft(t,e){return t<<e|t>>>32-e}function md5cmn(t,e,r,n,o,i){return safeAdd(bitRotateLeft(safeAdd(safeAdd(e,t),safeAdd(n,i)),o),r)}function md5ff(t,e,r,n,o,i,a){return md5cmn(e&r|~e&n,t,e,o,i,a)}function md5gg(t,e,r,n,o,i,a){return md5cmn(e&n|r&~n,t,e,o,i,a)}function md5hh(t,e,r,n,o,i,a){return md5cmn(e^r^n,t,e,o,i,a)}function md5ii(t,e,r,n,o,i,a){return md5cmn(r^(e|~n),t,e,o,i,a)}function binlMD5(t,e){var r,n,o,i,a;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var c=1732584193,s=-271733879,d=-1732584194,l=271733878;for(r=0;t.length>r;r+=16)n=c,o=s,i=d,a=l,c=md5ff(c,s,d,l,t[r],7,-680876936),l=md5ff(l,c,s,d,t[r+1],12,-389564586),d=md5ff(d,l,c,s,t[r+2],17,606105819),s=md5ff(s,d,l,c,t[r+3],22,-1044525330),c=md5ff(c,s,d,l,t[r+4],7,-176418897),l=md5ff(l,c,s,d,t[r+5],12,1200080426),d=md5ff(d,l,c,s,t[r+6],17,-1473231341),s=md5ff(s,d,l,c,t[r+7],22,-45705983),c=md5ff(c,s,d,l,t[r+8],7,1770035416),l=md5ff(l,c,s,d,t[r+9],12,-1958414417),d=md5ff(d,l,c,s,t[r+10],17,-42063),s=md5ff(s,d,l,c,t[r+11],22,-1990404162),c=md5ff(c,s,d,l,t[r+12],7,1804603682),l=md5ff(l,c,s,d,t[r+13],12,-40341101),d=md5ff(d,l,c,s,t[r+14],17,-1502002290),c=md5gg(c,s=md5ff(s,d,l,c,t[r+15],22,1236535329),d,l,t[r+1],5,-165796510),l=md5gg(l,c,s,d,t[r+6],9,-1069501632),d=md5gg(d,l,c,s,t[r+11],14,643717713),s=md5gg(s,d,l,c,t[r],20,-373897302),c=md5gg(c,s,d,l,t[r+5],5,-701558691),l=md5gg(l,c,s,d,t[r+10],9,38016083),d=md5gg(d,l,c,s,t[r+15],14,-660478335),s=md5gg(s,d,l,c,t[r+4],20,-405537848),c=md5gg(c,s,d,l,t[r+9],5,568446438),l=md5gg(l,c,s,d,t[r+14],9,-1019803690),d=md5gg(d,l,c,s,t[r+3],14,-187363961),s=md5gg(s,d,l,c,t[r+8],20,1163531501),c=md5gg(c,s,d,l,t[r+13],5,-1444681467),l=md5gg(l,c,s,d,t[r+2],9,-51403784),d=md5gg(d,l,c,s,t[r+7],14,1735328473),c=md5hh(c,s=md5gg(s,d,l,c,t[r+12],20,-1926607734),d,l,t[r+5],4,-378558),l=md5hh(l,c,s,d,t[r+8],11,-2022574463),d=md5hh(d,l,c,s,t[r+11],16,1839030562),s=md5hh(s,d,l,c,t[r+14],23,-35309556),c=md5hh(c,s,d,l,t[r+1],4,-1530992060),l=md5hh(l,c,s,d,t[r+4],11,1272893353),d=md5hh(d,l,c,s,t[r+7],16,-155497632),s=md5hh(s,d,l,c,t[r+10],23,-1094730640),c=md5hh(c,s,d,l,t[r+13],4,681279174),l=md5hh(l,c,s,d,t[r],11,-358537222),d=md5hh(d,l,c,s,t[r+3],16,-722521979),s=md5hh(s,d,l,c,t[r+6],23,76029189),c=md5hh(c,s,d,l,t[r+9],4,-640364487),l=md5hh(l,c,s,d,t[r+12],11,-421815835),d=md5hh(d,l,c,s,t[r+15],16,530742520),c=md5ii(c,s=md5hh(s,d,l,c,t[r+2],23,-995338651),d,l,t[r],6,-198630844),l=md5ii(l,c,s,d,t[r+7],10,1126891415),d=md5ii(d,l,c,s,t[r+14],15,-1416354905),s=md5ii(s,d,l,c,t[r+5],21,-57434055),c=md5ii(c,s,d,l,t[r+12],6,1700485571),l=md5ii(l,c,s,d,t[r+3],10,-1894986606),d=md5ii(d,l,c,s,t[r+10],15,-1051523),s=md5ii(s,d,l,c,t[r+1],21,-2054922799),c=md5ii(c,s,d,l,t[r+8],6,1873313359),l=md5ii(l,c,s,d,t[r+15],10,-30611744),d=md5ii(d,l,c,s,t[r+6],15,-1560198380),s=md5ii(s,d,l,c,t[r+13],21,1309151649),c=md5ii(c,s,d,l,t[r+4],6,-145523070),l=md5ii(l,c,s,d,t[r+11],10,-1120210379),d=md5ii(d,l,c,s,t[r+2],15,718787259),s=md5ii(s,d,l,c,t[r+9],21,-343485551),c=safeAdd(c,n),s=safeAdd(s,o),d=safeAdd(d,i),l=safeAdd(l,a);return[c,s,d,l]}function binl2rstr(t){var e,r="",n=32*t.length;for(e=0;n>e;e+=8)r+=String.fromCharCode(t[e>>5]>>>e%32&255);return r}function rstr2binl(t){var e,r=[];for(r[(t.length>>2)-1]=void 0,e=0;r.length>e;e+=1)r[e]=0;var n=8*t.length;for(e=0;n>e;e+=8)r[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return r}function rstrMD5(t){return binl2rstr(binlMD5(rstr2binl(t),8*t.length))}function rstrHMACMD5(t,e){var r,n,o=rstr2binl(t),i=[],a=[];for(i[15]=a[15]=void 0,o.length>16&&(o=binlMD5(o,8*t.length)),r=0;16>r;r+=1)i[r]=909522486^o[r],a[r]=1549556828^o[r];return n=binlMD5(i.concat(rstr2binl(e)),512+8*e.length),binl2rstr(binlMD5(a.concat(n),640))}function rstr2hex(t){var e,r,n="";for(r=0;t.length>r;r+=1)e=t.charCodeAt(r),n+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return n}function str2rstrUTF8(t){return unescape(encodeURIComponent(t))}function rawMD5(t){return rstrMD5(str2rstrUTF8(t))}function hexMD5(t){return rstr2hex(rawMD5(t))}function rawHMACMD5(t,e){return rstrHMACMD5(str2rstrUTF8(t),str2rstrUTF8(e))}function hexHMACMD5(t,e){return rstr2hex(rawHMACMD5(t,e))}function md5(t,e,r){return e?r?rawHMACMD5(e,t):hexHMACMD5(e,t):r?rawMD5(t):hexMD5(t)}var ErrorStack=function(){function t(e){_classCallCheck(this,t),this.env=e||checkEnv(),this.stackFilter=generateHandler(this.env).filter}return _createClass(t,[{key:"makeReg",value:function(){switch(this.env){case"iOS":return/(?:\s*)\w+(?=@)|(?:@).*?(?=:\d*:)|(?::)\d*(?=:)|(?::)\d*$/g;default:return null}}},{key:"stackFormatter",value:function(t){var e=t.message,r=[],n="Android"===this.env,o="iOS"===this.env,i=t.stack.split("\n").filter(this.stackFilter);i.shift();var a=i.join("\n"),c=this.makeReg();return c?i.map((function(t){var e=t.match(c);if(e){var i=_slicedToArray(e,4),a=i[0],s=void 0===a?"":a,d=i[1],l=void 0===d?"":d,f=i[2],u=void 0===f?"":f,h=i[3],p=void 0===h?"":h,g=n?s.split(".").reverse()[0]:s,m=o?1:0;r.push("at ".concat(g," (").concat(l.substr(m),":").concat(u.substr(m),":").concat(p.substr(m),")"))}else r.push(t);return null})):r=i,{hash:this.encryptStack(e,r),message:e,stackList:r,stackStr:a}}},{key:"encryptStack",value:function(t,e){var r=[].concat(_toConsumableArray(e.slice(0,6)),_toConsumableArray(e.slice(7,8)),_toConsumableArray(e.slice(9,10)),_toConsumableArray(e.slice(11,12)),_toConsumableArray(e.slice(13,14))).join(";");return md5("".concat(t,":").concat(r))}}]),t}(),STACK_LENGTH_LIMIT=20,ChromeREGEX=/^\s*at .*? ?\(((?:file|https?|blob|chrome-extension|native|eval|<anonymous>).*?)(?::\d+)?(?::\d+)?\)?\s*$/i,GeckoREGEX=/^\s*.*?(?:\(.*?\))?(?:^|@)((?:file|https?|blob|chrome|resource|\[native).*?)(?::\d+)?(?::\d+)?\s*$/i,WinJSREGEX=/^\s*at (?:(?:\[object object\])?.+ )?\(?((?:file|ms-appx|https?|blob):.*?):\d+(?::\d+)?\)?\s*$/i;function parseStack(t){for(var e=t.slice(0,STACK_LENGTH_LIMIT),r=["",""],n={},o=1,i=0;e.length>i;i+=1){var a=ChromeREGEX,c=(e[i]||"").match(a);if(null===c&&(c=(e[i]||"").match(a=GeckoREGEX)),null===c&&(c=(e[i]||"").match(a=WinJSREGEX)),null!==c){var s=c[1],d=n[s];void 0===d&&(n[s]="#".concat(o,"#"),o+=1,d=n[s]),e[i]=e[i].replace(s,d)}}e.length>0&&(r[1]=e.map((function(t){return t.trim()})).join(""));var l="";for(var f in n)n.hasOwnProperty(f)&&(l+="".concat(f,"@").concat(n[f],";"));return l=l.replace(/;$/,""),r[0]=l,r.join("").replace(/\^/g,"").replace(/=/g,"").replace(/,/g,"")}function unParseStack(t){var e=t&&t.split("")||[];if(!e[0]||!e[1])return t;for(var r={},n=e[0].split(";"),o=0;n.length>o;o+=1){var i=n[o]&&n[o].split("@#");r["#".concat(i[1])]=i[0]}return e[1].replace(/#[0-9]+#/g,(function(t){return r[t]||""})).replace(/\u0004/g,"^").replace(/\u0005/g,"=").replace(/\u0006/g,",").split("")}"undefined"==typeof process||_typeof$1(process);var helper={compressStack:function(t){return parseStack(t)},uncompressStack:function(t){return unParseStack(t)}},compressStack=helper.compressStack;function hashDetection(t,e){try{var r=new XMLHttpRequest;r.open("GET","https://dataservice.alipayobjects.com/alertserver/hash/".concat(t),!0),r.send(),r.onreadystatechange=function(){if(4===r.readyState){if(200===r.status||304===r.status)return;e(1)}}}catch(t){this._warn("hash 监测失败",t)}}var es=new ErrorStack;function logError(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=r.code||errorCodeEnums.JS,o="";if(t&&t.stack){var i=es.stackFormatter(t),a=i.hash,c=i.stackList;a&&c&&c.length&&hashDetection(a,(function(){e.log({code:errorCodeEnums.JS,s1:a,s2:compressStack(c),s3:1})})),o=a}this.log(_objectSpread2({code:n,msg:t.message,s10:o},r))}catch(t){this._warn("Tracert 异常上报失败:",t)}}function logHttpError(t){var e=t.status,r=t.url,n=t.method,o=t.query,i=t.data,a=t.response,c=t.traceId,s=t.code,d=_objectWithoutProperties(t,["status","url","method","query","data","response","traceId","code"]),l=_objectSpread2({code:s||2,msg:"".concat(n.toUpperCase()," ").concat(r)},d);e&&(l.s1=e),o&&(l.s2=o),i&&(l.s3=i),a&&(l.s4=a),c&&(l.s5=c),this.log(l)}function logRequestError(t){try{if(!t)return;var e=t.type,r=void 0===e?"http":e;"http"===r&&logHttpError.call(this,t)}catch(t){this._warn("Tracert 接口异常上报失败:",t)}}var win$1=window,metaFieldMap={bm_app_id:"_bmAppId",bm_sprint_id:"_bmSprintId",env:"_env"},context={_monitorInited:!1,_monitorConfigInited:!1,_monitorConfigFailed:!1,_defaultExceptionSeedId:"102023",_bmAppId:"",_bmSprintId:"",_cachedHttpLines:[],_env:"",_cacheLogs:[],_trackedLogs:[],_monitorConfigs:[],_lastAction:"0".concat(getTime(),""),log:log,logError:logError,logRequestError:logRequestError,_preproccess:preproccess,_handleErrorOptions:handleErrorOptions$1,_initException:function(t){if(!this._monitorInited){for(var e=util.nodeListToArray(window.document.getElementsByTagName("meta")),r={},n=0,o=0;e.length>o;o++){var i=e[o],a=util.getAttr(i,"name"),c=util.getAttr(i,"content"),s=metaFieldMap[a];s&&c&&!this[s]&&(r[s]=c,n++)}t.TRACERT_ENV&&(r._env=t.TRACERT_ENV),n&&this.set(r),this._monitorInited=!0}},getErrorEventHandler:function(t){return function(e){t.isErrorHandler=!0,t._handleErrorOptions(e,(function(e){t.log(e)}))}},initMonitorConfigs:function(t){var e=t.monitors,r=void 0===e?[]:e;if(!this._disableInterface)for(var n=0;r.length>n;n++){var o=r[n];if(o.code===errorCodeEnums.REQUEST&&o.isActive&&!o.isDeleted){interfaceRegister(this);break}}this.set({_monitorConfigs:r}),this._monitorConfigInited=!0,this._onMonitorConfigInited()},_onMonitorConfigInited:function(){var t=this._cacheLogs;if(t.length){for(var e=0;t.length>e;e++)this.log(t[e]);this._cacheLogs=[]}},_warn:function(){if("object"===_typeof(win$1)&&win$1.console&&"function"==typeof win$1.console.warn&&this.debug){var t=Array.prototype.slice.call(arguments);win$1.console.warn.apply(null,["[Tracert Debug]".concat(t[0])].concat(t.slice(1)))}},_debug:function(){if("object"===_typeof(win$1)&&win$1.console&&"function"==typeof win$1.console.log&&this.debug){var t=Array.prototype.slice.call(arguments);win$1.console.log.apply(null,["[Tracert Debug]".concat(t[0])].concat(t.slice(1)))}}},win$2=window,doc$1=win$2.document;function register(t){try{if(!doc$1)return t.warn("当前为非 web 环境，不支持报错监听与插件使用"),this;if(t.isErrorHandler)return void t.warn("错误事件已监听");util.addEvent("error",win$2,t.getErrorEventHandler(t)),util.addEvent("unhandledrejection",win$2,t.getErrorEventHandler(t))}catch(e){t.warn("Tracert 加载异常插件失败")}}function errorHandler(t){this._monitorConfigInited=!0,this._monitorConfigFailed=!0,this._onMonitorConfigInited(),this._warn("Tracert 获取服务端配置失败：",t)}function addScript(t){var e=this,r=errorHandler.bind(this),n=document.createElement("script");n.src=t,n.onerror=function(t){t.stopPropagation(),r.call(e,t)},document.head.appendChild(n),setTimeout((function(){e._monitorConfigInited||r.call(e,"超时")}),5e3)}function fetchConfig(Tracert){var onError=errorHandler.bind(Tracert);if(!Tracert._bmAppId)return setTimeout((function(){onError("没有 bmAppid")}));var isPre="pre"===Tracert._env,url="https://render.alipay.com/p/alertserver".concat(isPre?"_pre":"","/").concat(Tracert._bmAppId,"_config/index.js");window.AlipayJSBridge?window.AlipayJSBridge.call("httpRequest",{url:url,method:"GET",contentType:"application/json"},(function(res){if(res&&200===res.status)try{eval(res.data)}catch(t){onError(t)}else onError("未找到配置")})):addScript.call(Tracert,url)}function fetchConfig$1(t){try{fetchConfig(t)}catch(t){errorHandler.call(this)}}function send(t,e){t.postMessage(JSON.stringify(e),"*")}var verifyKey="__TRACERT_MONITOR_verify";function verify(t){var e,r=util.CrossIframe.initIframe();util.addEvent("load",r,(function(){send(e=r.contentWindow,{type:"storage",action:"get",key:verifyKey})})),util.addEvent("message",window,(function(r){try{var n=JSON.parse(r.data);if("getStorage"===n.type&&n.key===verifyKey){var o=JSON.parse(n.value)||{};o[t._bmAppId]=1,e&&send(e,{type:"storage",action:"set",key:verifyKey,value:JSON.stringify(o)})}}catch(t){}}))}function setVerify(t){t._bmAppId?util.load((function(){verify(t),setTimeout((function(){alert("请关闭该页面查看验证结果"),setTimeout((function(){window.parent&&window.parent.close&&window.parent.close()}))}),100)})):alert("未获取到应用ID")}var spliter="",doc$2=document,docEl$1=doc$2.documentElement;function setLastAction(t,e){try{var r=[],n="click"===t.type;r.push(n?1:2);var o=n?"".concat(getXPath(t.target,5)):"";r.push(o),r.push(getTime());var i=n?"".concat(t.x,"x").concat(t.y):"".concat(docEl$1.scrollLeft+doc$2.body.scrollLeft,"x").concat(docEl$1.scrollTop+doc$2.body.scrollTop);r.push(i);var a=t.target&&t.target.innerText,c=a?"".concat(a.slice(0,8)):"";r.push(c),e._lastAction=r.join(spliter)}catch(t){}}function lastAction(t){var e;util.addEvent("scroll",document,(function(r){e||(e=!0,setTimeout((function(){e=!1}),300),setLastAction(r,t))})),util.addEvent("click",document,(function(e){setLastAction(e,t)}))}function getQueries(){for(var t={},e=window.location.search.substring(1).split("&").map((function(t){return t.split("=")})),r=0;e.length>r;r++){var n=e[r];t[n[0]]=n[1]}return t}function handlePreCapture(t){var e=window.g_monitor;if(e){var r=e.listener,n=void 0===r?{}:r,o=e.events,i=void 0===o?[]:o;for(var a in n)n.hasOwnProperty(a)&&(util.removeEvent(a,window,n[a]),delete n[a]);for(var c=0;i.length>c;c++)t._handleErrorOptions(i[c],(function(e){t.log(e)}));e.events=[]}}var throttleWait=0,maxRecordLen=10,cachedHttpLineData=[];function sendHttpRequest(t){try{var e=new XMLHttpRequest;e.open("POST","https://mdap.alipay.com/loggw/dwcookieLogGet.do",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("data=".concat(t,"&time=").concat((new Date).getTime()))}catch(e){try{(new Image).src="".concat(this.server,"?data=").concat(t,"&time=").concat((new Date).getTime())}catch(t){this._warn("Tracert 通过 IMG 上报失败.",t)}}}var sendAll=null;function httpLog(t){0===throttleWait?sendHttpRequest(t):(cachedHttpLineData.push(t),sendAll&&sendAll())}function throttle(t){var e=null;return function(){var r=this,n=arguments;function o(){clearTimeout(e),e=null,t.apply(r,n)}maxRecordLen>cachedHttpLineData.length?e||(e=setTimeout((function(){o()}),throttleWait)):o()}}function getHttpLog(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return throttleWait=t,sendAll=throttle((function(){if(cachedHttpLineData.length){var t=cachedHttpLineData.join("$$");cachedHttpLineData=[],sendHttpRequest(t)}})),httpLog}function getInfoFromBridge(t){try{var e=window.AlipayJSBridge;e.call("getUserInfo",(function(e){t.cUserId=e.userId})),e.call("getStartupParams",(function(e){t.cOfflineVer=e.version,e.version&&(t.cAppId=e.appId)}))}catch(e){setTimeout((function(){t._warn("调用容器接口获取信息失败",e)}))}}function init(t,e){if(!t._monitorInited&&e&&"object"===_typeof(e)){var r=e.autoCapture,n=void 0===r||r,o=e.httpThrottle,i=void 0===o?{}:o;t.set({_bmAppId:e.bmAppid,_bmSprintId:e.bmSprintId,_disableInterface:!!e.disableInterface,oncePerSession:!!e.oncePerSession,beforeLog:e.beforeLog}),t._httpLog=getHttpLog(i.wait||0);var a=getQueries();t._initException(a),fetchConfig$1(t),window.AlipayJSBridge?getInfoFromBridge(t):document.addEventListener("AlipayJSBridgeReady",(function(){getInfoFromBridge(t)}),!1),"1"===a.TRACERT_VERIFY&&setVerify(t),handlePreCapture(t),n&&register(t),lastAction(t)}}window.hashDetection=hashDetection;var index=function(t,e){return t.set(_objectSpread2({},context)),init(t,t.monitorOptions),t.after("start",(function(){init(t,t.monitorOptions)})),t.before("set",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.monitorOptions;init(t,r)})),e(),t};return index}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginPerformance=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;arguments.length>n;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a=function(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}},n.exports),n.exports}((function(e){var t,n;t="undefined"!=typeof self?self:i,n=function(){if("object"==typeof window){var e,t=window,n={0:"navigate",1:"reload",2:"back_forward"},r=["unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart"];return t&&t.performance&&"object"==typeof t.performance&&t.performance.timing?"function"==typeof t.performance.getEntries&&"function"==typeof t.performance.getEntriesByType&&"function"==typeof t.performance.getEntriesByName&&"function"==typeof t.performance.now&&t.performance.timeOrigin?t.performance:e={_entry:function(){for(var e=t.performance.timing,o=e.navigationStart||e.redirectStart||e.fetchStart,i={entryType:"navigation",initiatorType:"navigation",name:t.location.href,startTime:0,duration:e.loadEventEnd?e.loadEventEnd-o:0,redirectCount:t.performance.navigation.redirectCount,type:n[t.performance.navigation.type]},a=0;r.length>a;a++){var c=r[a],f=e[c];i[c]=f?f-o:0}return i}(),timeOrigin:t.performance.timing.navigationStart,getEntries:function(){return[this._entry]},getEntriesByType:function(e){return"navigation"!==e?[]:[this._entry]},getEntriesByName:function(e){return e!==t.location.href?[]:[this._entry]},now:function(){return Date.now()-t.performance.timing.navigationStart}}:e}},e.exports?e.exports=n():t.timing2=n()}));var c=function(e){var t=e.records,n=e.start,r=e.timeout,o=e.load;if(0===t.length)return"number"==typeof r?r:0;"number"==typeof o&&t.forEach((function(e){e.weight=Math.pow(.5,Math.abs(parseFloat(e.t)-o)/1e3)}));var i=t.map((function(e,n){if(0===n)return 0;var r=t[n-1];return e.domCnt===r.domCnt?0:(e.domCnt-r.domCnt)/(e.t-r.t)*("number"==typeof e.weight?e.weight:1)})),a=Math.max.apply(null,i),c=i.indexOf(a);return t[c].t-n},f="number"==typeof __PAINTY_STACK_LIMIT__?__PAINTY_STACK_LIMIT__:100;function u(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():Date.now()}var d=["connectEnd","connectStart","decodedBodySize","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domainLookupEnd","domainLookupStart","duration","encodedBodySize","fetchStart","loadEventEnd","loadEventStart","redirectCount","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","transferSize","type","unloadEventEnd","unloadEventStart","workerStart","firstPaint","firstContentfulPaint","firstMeaningfulPaint"];function s(e,t){if("object"!==r(e)||"function"!=typeof e.getEntriesByType)return[];var n=[],o=e.getEntriesByType("navigation");if(!o||0===o.length)return[];var i=o[0],a=function(e){if("object"!==r(e))return[];var t=e.getEntriesByType("paint"),n={};if(t.length){var o=(t.filter((function(e){return"first-paint"===e.name}))[0]||{}).startTime,i=(t.filter((function(e){return"first-contentful-paint"===e.name}))[0]||{}).startTime;n.firstPaint=parseFloat(o),n.firstContentfulPaint=parseFloat(i)}return n}(e),c={firstMeaningfulPaint:t};return d.forEach((function(e){var t=i[e]||a[e]||c[e];n.push(null==t||"number"==typeof t&&isNaN(t)?"-":"number"==typeof t?parseFloat(t.toFixed(2)):t)})),n}var l=[10240,51200,102400,204800,512e3],m=l.length+1;function p(e){return l.reduce((function(t,n,r){var o=l[r-1]||0,i={name:"imageSizeGroup".concat(r,"Count"),field:"img_".concat(r),val:e.filter((function(e){return n>e.encodedBodySize&&e.encodedBodySize>o})).length};return t.concat(i)}),[]).concat({name:"imageSizeGroup".concat(m,"Count"),field:"img_".concat(m),val:e.filter((function(e){return e.encodedBodySize>l[l.length-1]})).length})}var g=function(e){return"script"===e.initiatorType&&e.name.indexOf(".js")>-1},y=function(e){return"link"===e.initiatorType&&e.name.indexOf(".css")>-1},v=function(e){return"h2"===e.nextHopProtocol},h=function(e){return/^.*font.*\.svg(\?|$|#)/.test(e.name)},b=function(e){return"img"===e.initiatorType||/\.(jpg|jpeg|png|bmp|webp|svg|ico)(\?|$|#)/.test(e.name)&&!h(e)},S=function(e){return"iframe"===e.initiatorType},E=function(e){return"css"===e.initiatorType&&(/\.(ttf|eot|woff)(\?|$|#)/.test(e.name)||h(e))},T=function(e){return e.decodedBodySize>e.encodedBodySize},w=function(e){return e.encodedBodySize>e.transferSize},j=function(e){return e.workerStart},C=function(e){return e.reduce((function(e,t){return e+t.encodedBodySize}),0)};var z=null;function O(t,n){var r={pid:"tracert",msg:t.message,code:n,page:location.href,c1:(t.stack||"").slice(0,500),c2:(t.stack||"").slice(500,1e3),c3:(t.stack||"").slice(1e3,1500)};(new Image).src="//gm.mmstat.com/fsp.1.1?".concat(e.objToStr(r,"&"))}function P(e,t){if("object"===r(t)&&!e.metricsSent)try{var i=t.getEntriesByType("navigation")[0],a=s(t,z),c=function(e,t){if("object"!==r(e))return[];var n=e.getEntriesByType("resource").filter((function(e){return e.startTime&&t>e.startTime}));if(0===n.length)return[];var o=n.filter(g),i=n.filter(y),a=n.filter(b),c=n.filter(E),f=n.filter(S);return{metrics:[{name:"resourceCount",field:"rcnt",val:n.length},{name:"resourceSize",field:"rsize",val:C(n)},{name:"jsCount",field:"jscnt",val:o.length},{name:"jsSize",field:"jssize",val:C(o)},{name:"cssCount",field:"csscnt",val:i.length},{name:"cssSize",field:"csssize",val:C(i)},{name:"imageCount",field:"imgcnt",val:a.length},{name:"imageSize",field:"imgsize",val:C(a)},{name:"fontCount",field:"fontcnt",val:c.length},{name:"fontSize",field:"fontsize",val:C(c)},{name:"iframeCount",field:"iframecnt",val:f.length},{name:"iframeSize",field:"iframesize",val:C(f)},{name:"Http2EnabledCount",field:"h2cnt",val:n.filter(v).length},{name:"compressedResourceCount",field:"crcnt",val:n.filter(T).length},{name:"cachedResourceCount",field:"carcnt",val:n.filter(w).length},{name:"serviceWorkerResourceCount",field:"swrcnt",val:n.filter(j).length}],imageGroupMetrics:p(a)}}(t,i.duration),f=function(e,t){return"object"!==r(e)?[]:e.getEntriesByType("resource").filter((function(e){return["xmlhttprequest","fetch"].indexOf(e.initiatorType)>-1&&t>=e.startTime})).map((function(e){return[e.name.split("?")[0],e.startTime,e.transferSize,Math.round(e.responseStart-e.startTime),e.duration]}))}(t,i.duration);e.send(e.seedIdCfg.perfSeedId,n(n({nav:a.join("_")},(c.metrics||[]).reduce((function(e,t){return n(n({},e),{},o({},t.field,Math.round(t.val)))}),{})),{},{img_group:(c.imageGroupMetrics||[]).map((function(e){return e.val})).join("_"),network:navigator.connection&&navigator.connection.effectiveType||"-",partial:0===i.duration?1:0,ajax:f.map((function(e){return e.join("-")})).join("_"),title:document.title,visible:document.hidden?0:1})),e.metricsSent=!0}catch(e){O(e,12)}}function B(t){if("object"!==r(a))return t;try{!function(e,t){if("object"==typeof window&&"object"==typeof a){"function"==typeof e&&(t=e);var n=[],r=function e(){if("function"==typeof MutationObserver){var t=new MutationObserver((function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f&&i()}));return t.observe(document,{childList:!0,subtree:!0}),t.disconnect.bind(t)}var r=setTimeout((function(){n.push({t:u(),domCnt:document.getElementsByTagName("*").length}),n.length===f?i():e()}),200);return function(){clearTimeout(r)}}();if("number"==typeof e)setTimeout(i,e);else{var o=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);window.addEventListener(o?"pagehide":"beforeunload",i)}}function i(){if(r(),"object"==typeof a&&"function"==typeof a.getEntriesByType){var o=a.getEntriesByType("navigation");if(o&&o.length){var i=o[0];t(c({records:n,start:i.startTime,timeout:e,load:i.duration}))}}}}((function(e){z=e})),"function"==typeof a.setResourceTimingBufferSize&&a.setResourceTimingBufferSize(500);var n=!!navigator.userAgent.match(/iPhone|iPad|iPod/i);e.ownAddEventListener(n?"pagehide":"beforeunload",window,P.bind(null,t,a),!1)}catch(e){O(e,11)}return t}return function(e,t){return B(e),t(),e}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginClickAndExpo=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);t>n;n++)r[n]=e[n];return r}function l(e,t){return window.getComputedStyle(e,t)}Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var r=arguments[1],o=0;n>o;){var i=t[o];if(e.call(r,i,o,t))return i;o++}},configurable:!0,writable:!0});var f=16,s=["deer-analysis-render-container","mocha"],d=[200,50],h=["svg","i","p","iframe","pre"],p=["label","input","button","img","iframe"],v=["svg","iframe","form","table"],g=["ul","header","section","article","aside"];function m(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}function y(e){if(Object&&Object.values)return Object.values(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t}function b(e,t){var n=m(e);if(0!==n.length){for(var r=0;n.length>r;r++)if(5>=Math.abs(n[r]-t))return void e[n[r]]++;e[t]=1}else e[t]=1}function w(e,t){if(!e||!e.children)return[];var n=[].slice.call(e.children)||[];return t?n.filter(t):n}function x(t){var n=e.getTagName(t).toLowerCase();return"div"===n||"span"===n?"span":n}function k(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=w(t,(function(e){return 8!==e.nodeType})),o=r.length;if("ul"===e.getTagName(t).toLowerCase())return!0;if(1>=o&&n>o)return!1;if(o>100)return!1;for(var i="",a=!0,c={},u={},l={},s=0,d=0;o>d;d++){var h=r[d],v=x(h);if(-1!==p.indexOf(v))return!1;if(h.offsetWidth>400&&h.offsetHeight>400)return!1;(f>h.offsetWidth||f>h.offsetHeight)&&s++;var g=Math.max(5,h.offsetWidth);b(c,g);var k=Math.max(5,h.offsetHeight);b(u,k);for(var T=0;h.classList.length>T;T++){var S=h.classList[T];l[S]=(l[S]||0)+1}if(a=i?i===v:a,i=v,!a)return!1}return a&&o/2>s&&-1!==y(l).indexOf(o)&&2>=m(c).length&&m(u).length<=o/2}function T(e){var t={};if(!e.attributes)return{};for(var n=0;e.attributes.length>n;n++){var r=e.attributes[n];t[r.name]=r.value}return t}function S(t){for(;t&&t.childNodes&&t.childNodes.length;){var n=[].slice.call(t.childNodes);if(n.find((function(e){return 3===e.nodeType})))return!0;t=n.filter((function(t){return!!e.getTagName(t)})).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0]}return!!t&&!![].slice.call(t.childNodes||[]).find((function(e){return 3===e.nodeType}))}for(var O=["div","span","a","p","button","ul","li","ol","img","h1","h2","h3","h4","h5","h6","form"],C={},N=0;16>N;N++)C[O[N]]=N;function E(e){return function(e){var t=e.split(arguments.length>1&&void 0!==arguments[1]?arguments[1]:">");return Array.isArray(t)?t:[t]}(e,">").map((function(e){var t=e.split(":"),n=t[0],r=t[1],o=C.hasOwnProperty(n)?"".concat(C[n].toString(16)):n,i=r?r.replace(/nth-child\((\d+)\)/g,(function(e,t){return"".concat(t)})).replace(/nth-of-type\((\d+)\)/g,(function(e,t){return"t".concat(t)})):"";return"".concat(o).concat(i?"".concat("`").concat(i):"")})).join(">")}function j(e){var t=e.indexOf("\n");return-1!==t&&(e=e.substring(0,t)),e.trim().substring(0,15)}function I(t){if(!t||5===t.nodeType)return"";if(3===t.nodeType)return window.Text&&t instanceof Text?t.wholeText:t;if(!function(e){try{return e instanceof HTMLElement}catch(t){return"object"===n(e)&&1===e.nodeType&&"object"===n(e.style)&&"object"===n(e.ownerDocument)}}(t))return"";switch(e.getTagName(t).toLowerCase()){case"img":return"img:".concat(t.src);case"canvas":return"canvas"}var r=function(e){return e.childNodes||[]}(t),o=w(t),i=T(t);return 0===r.length||function(e){for(var t=0;e.length>t;t++)if(3===e[t].nodeType)return!0;return!1}(r)||0===o.length?t.innerText||i.placeholder||i.alt||l(t,":before").content||l(t,":after").content:I(o[0])}function L(e){var t=I(e);if(t&&"string"==typeof t)return j(t.replace(/\s/g,""));if(!e||w(e).length>3)return"";var n=e.innerText;return n?j(n):3>w(e.parentNode).length?j(L(e.parentNode)):""}function P(e){var t,n=w(e);if(!n||!n.length)return L(e);if(1===n.length)return j(P(n[0]));for(;(t=w(e))&&t.length;)return j(L(e=[].slice.call(t).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0]));return""}function D(e){var t=l(e);return!t||("SCRIPT"===e.tagName||"none"===t.display||"relative"===t.position&&null===e.offsetParent||"absolute"===t.position&&(5>Math.abs(parseFloat(t.left)+e.offsetWidth)||5>Math.abs(parseFloat(t.top)+e.offsetHeight))||5>e.offsetWidth||5>e.offsetHeight)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(0===t)return!1;var n=w(e);if(0===n.length)return e.clientHeight>d;for(var r=0;n.length>r;r++){var o=n[r],i=l(o);if(("absolute"===i.position||i.float)&&o.clientHeight>50)return!0;if(A(o,t-1))return!0}return!1}function H(e){var t=e.getAttribute("id");return t&&t.substring(0,10)}function W(e){return e.classList&&e.classList.length?".".concat([].slice.call(e.classList,0,2).join(".")):""}function _(e){return e.id?H(e):W(e)}function M(e){return e.offsetWidth*e.offsetHeight}function R(e){var t=w(e);if(2>t.length||t.length>3)return!1;if(k(e,2))return!1;var n=e.offsetWidth,r=t[0],o=r.offsetWidth,i=r.offsetHeight,a=parseInt(l(r).lineHeight,10)||16;return o>=200&&o>=.9*n&&((!i||i>=a&&4*a>=i)&&!!S(r))}function B(t){var n=t;if(n.__possibleBlock)return!0;if("a"===e.getTagName(t).toLowerCase())return!1;if(function(e){return e.id&&-1!==s.indexOf(e.id)}(n))return!1;if(k(n))return!1;var r=w(n);return!(!r||!r.length)&&(n.offsetWidth>=200&&n.offsetHeight>=50)}function U(e){var t=w(e);if(t.length>200)return!0;for(var n=0;t.length>n;n++)if(T(t[n]).hasOwnProperty("contenteditable"))return!0;return!1}function q(t){var n,r=e.getTagName(t).toLowerCase(),o=t.parentNode;if(k(t.parentNode)&&o.children&&o.children.length){for(var i=0,a=0;o.children.length>a;a++){var c=o.children[a];if(e.getTagName(c).toLowerCase()===r&&i++,c===t)break}return"".concat(r,":nth-of-type(").concat(i,")")}for(var u=0;o.children.length>u;u++)if(o.children[u]===t){n=u+1;break}return"".concat(r,":nth-child(").concat(n,")")}function F(t){if(!t)return!1;var n=window.getComputedStyle(t);return"BODY"!==e.getTagName(t)&&"fixed"===n.position&&function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return!1;var n=e.getBoundingClientRect(),r=window.innerHeight/2,o=50>Math.abs(n.top+n.height/2-r),i=window.innerWidth/2,a=50>Math.abs((n.right-n.left)/2-i);return 1===t?o||a:o&&a}(t)&&function(e){if(!e)return!1;var t=window.getComputedStyle(e);return 50>Math.abs(e.offsetWidth-window.innerWidth)&&50>Math.abs(e.offsetHeight-window.innerHeight)&&("fixed"===t.position||e.offsetParent===document.body)}(t)}function J(e){var t=e.getBoundingClientRect();return 50>=Math.abs(t.width-window.innerWidth)&&(120>=t.height&&t.y<=t.height)}function V(e){var t=e.getBoundingClientRect();return 50>=Math.abs(t.width-window.innerWidth)&&(120>=t.height&&Math.abs(t.bottom-(e.offsetParent||document.body).offsetHeight)<=50)}window.getNodeText=L,window.getFirstNodeText=I,window.getBlockTitle=P,window.possibleBlock=B,window.possibleHeadedBlock=R;var G=["data-node-selector","data-block-selector"];function $(e,t){var n=2>=arguments.length||void 0===arguments[2]||arguments[2],r=t||document.body;if(e===r||e===document.body)return"body";if(n)for(var o=0;2>o;o++)if(e&&e[G[o]])return e[G[o]];var i=e,a=[];do{a.unshift(q(i))}while(i.parentNode&&i.parentNode!==document.body&&i.parentNode!==r&&(i=i.parentNode));return a.join(">")}window._getSelector=$,window._isModal=F;var Y={};function z(e){var t=1>=arguments.length||void 0===arguments[1]||arguments[1];return e.map((function(e){var n=e.node,r=e.selector||$(n,document.body,t);return n["data-block-selector"]=r,{block:n,selector:E(r)}}))}function K(e,t){var n=document.querySelector(e);if(!n||!function(e,t){if(e.contains&&"function"==typeof e.contains)return e.contains(t);var n=t;do{if(e===n)return!0}while(n=n&&n.parentNode);return!1}(n,t)){var r=Y[e];if(r){var o=$(r);return r["data-block-selector"]=o,Y[o]=r,r}return null}return n}function Q(e){var t,n=(t=window.visualViewport)?[t.offsetLeft,t.offsetTop,t.width,t.height]:[0,0,window.innerWidth,window.innerHeight],r=n[1],o=n[0]+n[3],i=e.getBoundingClientRect(),a=i.top,c=i.bottom,u=i.height;return r>=a&&c>=o||a>=r&&o>=c||a>=r&&o-a>=Math.min(300,u/2)||o>=c&&c-r>=Math.min(300,u/2)}function X(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{time:0,cnt:0},r=n.time,o=void 0===r?0:r,i=n.cnt,a=void 0===i?0:i,c={};if(!t)return c;var u=t.exposedTime+o,l=t.exposedCnt+a;return t.empty()&&document.body.contains(t.dom)?c[E($(t.dom))]={time:u,cnt:l,title:t.title,type:t.type,id:H(t.dom),cls:W(t.dom)}:e.objectAssign(c,t.children.reduce((function(t,n){return e.objectAssign(t,X(n,{time:u,cnt:l}))}),c)),c}var Z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body,n=arguments.length>1?arguments[1]:void 0;r(this,e),this.dom=document.body,this.children=[],this.selector="",this.lastExposingTime=0,this.exposedTime=0,this.exposedCnt=0,this.title="",this.type="",this.dom=t,this.type=n,this.title=P(t),this.expo()}return i(e,[{key:"visible",value:function(){return!!this.dom&&(!D(this.dom)&&Q(this.dom))}},{key:"pause",value:function(){this.empty()?this.unexposed(!0):[].concat(this.children.filter((function(e){return e.pause()})))}},{key:"expo",value:function(){if(!this.empty())return[].concat(this.children.filter((function(e){return e.expo()})));var e=this.dom;return this.visible()?(this.exposed(),[e]):(this.unexposed(),[])}},{key:"getExposed",value:function(e){return X(this,e)}},{key:"exposed",value:function(){return this.lastExposingTime?this.exposedTime+=Date.now()-this.lastExposingTime:this.exposedCnt++,this.lastExposingTime=Date.now(),this.exposedTime}},{key:"unexposed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.lastExposingTime){var t=Date.now()-this.lastExposingTime;(e||t>500)&&(this.exposedTime+=t)}return this.lastExposingTime=0,this.exposedTime}},{key:"empty",value:function(){return!this.children.length}},{key:"update",value:function(e){var t=this;e.forEach((function(e){return t.insert(e.node,e.type)})),z(e,!1)}},{key:"contains",value:function(e){return this.dom!==e&&this.dom.contains(e)}},{key:"insert",value:function(t,n){var r=this;if(this.children=this.children.filter((function(e){return r.contains(e.dom)})),!this.children.find((function(e){return e.dom===t}))){var o=this.children.find((function(e){return e.contains(t)}));o?o.insert(t,n):this.children.push(new e(t,n))}}}]),e}();function ee(){return new Z}var te=e.addEvent,ne=e.debounce,re=e.storage,oe=e.getAttr;function ie(t){for(var n,r=[],o=[],i=0;t.length>i;i++){var a=t[i];a&&((n=a).id&&-1!==s.indexOf(n.id)||-1!==h.indexOf(e.getTagName(n).toLowerCase())||D(a)?o.push(a):r.push(a))}return{ordered:r,disorderd:o}}function ae(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!t)return[];for(var r=[],o=[],i=ie(t),a=i.ordered,c=i.disorderd,u=0;c.length>u;u++){var l=c[u];A(l)&&(l.__possibleBlock=!0,a.push(l))}a.sort((function(e,t){return M(e)-M(t)}));for(var f=0;a.length>f;f++){var s=a[f],d=w(s);if(oe(s,"data-aspm"))r=r.concat({node:s,type:"spm",selector:oe(s,"data-aspm")});else if(s&&e.getTagName(s)&&-1!==v.indexOf(e.getTagName(s).toLowerCase()))r=r.concat([{node:s,type:"short"}]);else if(U(s))r=r.concat([{node:s,type:"ugc"}]);else if(k(s))r=r.concat([{node:n[0],type:"list"}]);else if(F(s))r=r.concat([{node:s,type:"modal"}]);else if(J(s))r=r.concat([{node:s,type:"header"}]);else if(V(s))r=r.concat([{node:s,type:"footer"}]);else{if(R(s)){var h=function(){var e=ae(d,[s].concat(n)),t=[],o=[];return e.forEach((function(e){"pattern"===e.type?t.push(e):o.push(e)})),r=r.concat(t&&t.length?t.concat(o):[{node:s,type:"pattern"}]),"continue"}();if("continue"===h)continue}if(s.offsetWidth>document.body.offsetWidth)r=r.concat(ae(d,[s].concat(n)));else if(B(s)){if(1===d.length){var p=ae(d,[s].concat(n),!0);r=r.concat(p&&p.length?p:[{node:s,type:"hoist"}]);continue}var g=ae(d,[s].concat(n),!0);g&&g.length?r=r.concat(g):o.push({node:s,type:"stashed"})}else o.push({node:s,type:"stashed"})}}if(r.length>1){for(var m=0,y=n[0]||t[0],b=0;r.length>b;b++)if("list"===r[b].type&&m++,r[b].node===n[0]){if(y.__possibleBlock){r=r.concat([{node:y.parentNode,type:"hoist"}]);break}return[{node:y,type:"merge"}]}if(m>=r.length/2)return[{node:y,type:"hoist"}]}return o.length&&(r=a.length/2>r.length?[{node:n[0]||t[0],type:"end"}]:r.concat(o)),r}window._pickLayout=ae;var ce=function(){function e(t){var n=this;r(this,e),this.layout={},this.expoTree=null,this.paused=!1,this.pause=function(e){e.target!==window&&e.target!==document||n.paused||(n.expoTree.pause(),n.paused=!0)},this.resume=function(){n.paused&&(n.expoTree.expo(),n.paused=!1)},this.restore=function(){var e=n.tracert,t=re.get("exposed",{},!0);if(t){var r=t.split("|"),o=r[0],i=r[1];try{var a=decodeURIComponent(o),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500,n=[];for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],i=o.time;n.push({time:i,text:[r,i,"",o.cnt,o.type,o.id,o.cls].join("")})}for(var a=n.sort((function(e,t){return t.time-e.time})),c=[],u=t,l=0;a.length>l;l++){var f=a[l].text,s=void 0===f?"":f;if(s.length>u)break;u-=s.length,c.push(s)}return c.join("")}(JSON.parse(i));a===n.tracert.refUrl&&e.after("start",(function(){e.call("expo","deer_expo","",{expo:c})}))}catch(e){}}},this.timeout=null,this.timeoutLog=function(){n.log(),n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout((function(){return n.log()}),500)},this.log=function(){n.paused||(n.cacheLayout(),n.expoTree.empty()||(n.expoTree.expo(),re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(X(n.expoTree))))))},this.tracert=t,this.expoTree=ee(),this.events()}return i(e,[{key:"events",value:function(){var e=this;te("blur",window,this.pause),te("focus",window,this.resume),te("visibilitychange",document,(function(t){"hidden"===document.visibilityState?e.pause(t):"visible"===document.visibilityState&&e.resume()})),te("scroll",window,ne((function(){return e.log()}),200)),te("beforeunload",window,(function(){e.expoTree.expo();var t=X(e.expoTree);re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t)))})),this.tracert.before("logPv",(function(){e.restore(),e.expoTree.expo();var t=X(e.expoTree);re.set("exposed","".concat(encodeURIComponent(location.href),"|").concat(JSON.stringify(t))),Y={},e.expoTree=ee(),e.timeoutLog()}))}},{key:"cacheLayout",value:function(){var e=ae([document.body]);return this.expoTree.update(e),this.layout}},{key:"get",value:function(){return this.layout}}]),e}();window.isList=k;var ue=document&&document.body?.5*document.body.scrollWidth:0;function le(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e||!e.length)return null;if(!t||!t.length)return null;if(t.length>e.length-n)return null;var r=Array.isArray(t[0])?t[0]:[t[0]];return r.find((function(t){return e[n].cursor===t}))?1===t.length?0===n?null:e[n-1].node:le(e,t.slice(1),n+1):le(e,t,n+1)}function fe(t){var n=t;if(t instanceof SVGElement&&"svg"!==e.getTagName(t).toLowerCase())try{return fe(t.ownerSVGElement)}catch(e){return console.debug("Failed to get ownerSVGElement"),{node:parent,type:5}}var r=[];do{if(t.id&&-1!==s.indexOf(t.id))return null;var o=T(t);if(t["data-block"]&&t["data-node-selector"])return{node:t,type:"CACHED",nodeSelector:t["data-node-selector"]};if(o["data-aspm"])break;if(o["data-aspm-click"])return{node:t,nodeSelector:"".concat(o["data-aspm-click"]),spm:!0,type:0};if("a"===e.getTagName(t).toLowerCase())return{node:t,type:1};if(-1===p.indexOf(e.getTagName(t).toLowerCase())){var i=l(t).cursor||"default";r.push({node:t,type:3,cursor:i})}else r.push({node:t,type:2})}while(t.parentNode&&t.parentNode!==document.body&&(t=t.parentNode));for(var a=0;r.length>a;a++){var c=r[a],u=c.type;if(2===u)return{node:c.node,type:u}}var f,d,h,v=le(r,["pointer",["default","auto"]]);return v?{node:v,type:3}:(d=(f=n).offsetWidth,h=f.offsetHeight,-1!==g.indexOf(e.getTagName(f).toLowerCase())||256>d*h||Math.max(d,h)>ue||!S(f)&&!l(f).backgroundImage?null:{node:n,type:4})}function se(t,n,r){var o=n.block,i=n.blockSelector,a=r.node,c=r.nodeSelector,u=r.nodeType,f=r.clickDom,s="";o&&(s=P(o),c=c||$(a,o));var d=L(t),h=e.getDomConfig(f);return function(e){var t=e.dom,n=e.extraParams,r=e.currentConfig,o=e.block,i=e.blockSelector,a=e.blockTitle,c=e.blockId,u=e.node,l=e.nodeId,f=e.nodeSelector,s=e.nodeText,d=e.clickText,h=i||$(o);if(o&&(o["data-block-selector"]=h,Y[i]=o),u){u["data-block"]=h;var p=f||$(u,o);u["data-node-selector"]=p,Y[p]=u}return{dom:t,extraParams:n,node:f||$(u),nodeText:s,nodeId:l,block:(i||$(o)).replace(/\[data-aspm="([\w-]+)"\]/g,(function(e,t){return t})),blockTitle:a,blockId:c,clickText:d,currentConfig:r}}({dom:t,extraParams:e.getDomParam(f),currentConfig:h,clickDom:f,node:a,nodeSelector:c,nodeMeta:{id:_(a),type:u,err:4===a.type&&"pointer"!==l(a).cursor},nodeId:_(a),nodeText:encodeURIComponent(d),block:o,blockTitle:encodeURIComponent(s),blockSelector:i,blockMeta:o?{id:_(o)}:null,clickText:encodeURIComponent(d)})}function de(e){if(!e||e===document.body)return null;var t=fe(e);if(!t)return null;var n=t.node,r=t.type,o=t.node;if("CACHED"===r){var i=n["data-block"],a=K(i,n);if(a)return se(e,{block:a,blockSelector:i},{node:n,nodeSelector:t.nodeSelector,clickDom:o})}var c=t.nodeSelector;if(0===r&&-1!==c.indexOf(".")){var u=c.split("."),l=u[0],f=u[1];return se(e,{block:document.querySelector('[data-aspm="'.concat(l,'"]')),blockSelector:l},{node:n,nodeSelector:f,nodeType:r,clickDom:o})}for(var s=n,d=!1,h="",p=[];s&&s.parentNode&&s.parentNode!==document.body;){var v=s=s.parentNode,g=T(s);if(g["data-aspm"]){d=!0,h='[data-aspm="'.concat(g["data-aspm"],'"]');break}p.unshift(v)}if(d)return se(e,{block:s,blockSelector:h},{node:n,nodeSelector:c,nodeType:r,clickDom:o});for(;s=p.pop();)if(s["data-block-selector"]){var m=s["data-block-selector"],y=K(m,s);if(!y)continue;return se(e,{block:y,blockSelector:m},{node:n,nodeSelector:c||$(n,y),clickDom:o})}var b=function(e){for(var t=e,n=[t];t.parentNode&&t.parentNode!==document.body;){var r=t.parentNode;n.push(r),t=r}return n}(e),w=function(e,t){for(var n=t.length;n>0;n--)for(var r=t[n],o=0;e.length>o;o++){var i=e[o].block;if(i===r)return i}return!1}(z(ae([document.body])),b);return w?se(e,{block:w,blockSelector:$(w)},{node:n,nodeSelector:c||$(n,w),clickDom:o}):null}var he,pe,ve,ge,me=window,ye="nameStorage:",be=/^([^=]+)(?:=(.*))?$/,we=encodeURIComponent,xe=decodeURIComponent,ke={},Te={};function Se(){var e,t=[],n=!0;for(var r in ke)ke.hasOwnProperty(r)&&(n=!1,e=ke[r]||"",t.push(we(r)+"="+we(e)));me.name=n?he:ye+we(he)+"?"+t.join("&")}!function(e){if(e&&0===e.indexOf(ye)){var t=e.split(/[:?]/);t.shift(),he=xe(t.shift())||"";for(var n,r,o,i=t.join("").split("&"),a=0,c=i.length;c>a;a++)(n=i[a].match(be))&&n[1]&&(r=xe(n[1]),o=xe(n[2])||"",ke[r]=o)}else he=e||""}(me.name),Te.setItem=function(e,t){e&&void 0!==t&&(ke[e]=t+"",Se())},Te.getItem=function(e){return ke.hasOwnProperty(e)?ke[e]:null},Te.removeItem=function(e){ke.hasOwnProperty(e)&&(ke[e]=null,delete ke[e],Se())},Te.clear=function(){ke={},Se()},Te.valueOf=function(){return ke},Te.toString=function(){var e=me.name;return 0===e.indexOf(ye)?e:ye+e},ve="beforeunload",ge=function(){Se()},(pe=me)&&(pe.addEventListener?pe.addEventListener(ve,ge,!1):pe.attachEvent&&pe.attachEvent("on"+ve,(function(e){ge.call(pe,e)}))),me.nameStorage=Te;var Oe=Te,Ce=e.url,Ne="https://render.alipay.com/p/s/deer-analysis-render/index.js?_t=".concat(Date.now()),Ee="https://render.alipay.com/p/s/deer-analysis-render/index.css?_t=".concat(Date.now()),je="data-extra-spm",Ie=[];function Le(t){if(t){var n=t.getAttribute(je);if(!n)return;var r=function(e){return function(t){t&&e&&(t.extraSpmIdSet||(t.extraSpmIdSet={}),e.split(",").forEach((function(e){t.extraSpmIdSet[e]=!0})))}}(n);e.addEvent("click",t,r),Ie.push([t,r])}}function Pe(t){t.refreshExtraClickListeners=function(){Ie.forEach((function(t){var n=c(t,2);e.removeEvent("click",n[0],n[1])})),Ie=[];for(var t=document.querySelectorAll("[data-extra-spm]"),n=0;t.length>n;n++)Le(t[n])},t.refreshExtraClickListeners()}var De=e.addEvent,Ae=e.inIframe;return function(n,r){var o,i=n;if(Ae()||!window.getComputedStyle||!document.body.classList)return r(),i;function c(t){o||(o=new ce(n,{layout:t}),n.set({_expo:o}),e.load((function(){var e=function(e){if(!e)return{};var t=e.split("&");if(!t.length)return{};for(var n={},r=0;t.length>r;r++){var o=(t[r]||"").split("=");n[o[0]]=o[1]||""}return n}(Ce.parse(location.href).query);if(e.deer_tracert_token||Oe.getItem("deer_tracert_token")){var t=document.createElement("script");t.type="text/javascript",t.src="".concat(Ne),document.getElementsByTagName("HEAD").item(0).appendChild(t);var n=document.createElement("link");n.href=Ee,n.rel="stylesheet",n.type="text/css",document.getElementsByTagName("HEAD").item(0).appendChild(n)}})))}return n._layout?c(n._layout):n.before("set",(function(e){e.hasOwnProperty("_layout")&&c(e._layout)})),De("click",document.body,(function(e){var n=de(e.target);n&&setTimeout((function(){var r=e.extraSpmIdSet,o=r?Object.keys(r):[],c=n.node,u=n.nodeText,l=n.nodeId,f=n.block,s=n.blockTitle,d=n.blockId,h=n.extraParams,p=n.currentConfig;c&&f&&i.after("start",(function(){i.call("click","".concat(E(f),".").concat(E(c)),function(e){for(var n=1;arguments.length>n;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({nodeText:u,nodeId:l,blockTitle:s,blockId:d,extraSpmIds:o},h),void 0,p)}))}),0)})),Pe(i),r(),i}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginClientSession=t(e.tracertUtil)}(this,(function(e){"use strict";var t=e.Cookies,i=e.uuid,n=".alipay.com",r=18e5,o="".concat(e.cookiesPrefix,"_SESSION"),a="tree";function u(){var e=t.get(o)||i();return t.set(o,e,{expires:new Date((new Date).getTime()+r),cookie:!0}),e}var c=e.objectAssign;return function(e,o){var f=e;return u(),f.before("logPv",(function(e){var o=function(e){var o={domain:document.domain&&-1!==document.domain.indexOf(n)?n:null,cookie:!0,expires:new Date((new Date).getTime()+r)},u=function(e,i,n){return t.set(a,[e,i,n].join(""),o),{_trid:i,_trll:n}},c=i();if(!e)return{};var f=t.get(a,o,!0);if(!f)return u(e,c,1);var s=f.split(""),l=s[0],d=s[1],p=s[2];return l!==e?u(l,c,1):u(l,d,parseInt(p,10)+1)}(f.spmAPos),s=u();e.__sid=s,c(e,o)})),o(),f}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginFullfillRef=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var n=t.addEvent,o=t.storage,a=t.nodeListToArray,i=t.getAttr,l=t.url,c=".alipay.com",f=function(){function t(e){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.isAlipayDomain=document.domain&&-1!==document.domain.indexOf(c),this.cookiesDomain=this.isAlipayDomain?c:null,this.tracert.before("logPv",(function(t){t=t||{};var e=r.get(),n=r.getMetaSpmId();n&&r.tracert.set({_spmId:n}),e&&e.metaSpmId&&(t._refSpm=e.metaSpmId,r.tracert.set({_refSpm:t._refSpm})),r.tracert.refUrl&&"-"!==r.tracert.refUrl&&e&&(r.tracert.set({refUrl:e.fullUrl}),r.tracert.referSPM||r.tracert.set({referSPM:e.refSpm}))})),n("click",window.document.body,(function(t){r.cache(t.target)}))}var f,u,s;return f=t,(u=[{key:"getMetaSpmId",value:function(){for(var t=a(window.document.getElementsByTagName("meta")),e="",r=0;t.length>r;r++){var n=t[r],o=i(n,"name"),l=i(n,"content");if(l&&o)switch(o){case"pagename":e=l}}return e?"".concat(this.tracert.spmAPos,".").concat(encodeURIComponent(e)):e}},{key:"cache",value:function(){var t=this.tracert.fullURL||"";t.length>150&&(t=this.tracert.url);var e=[t,"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),this.getMetaSpmId()];o.set("fullfill_ref",e.join(""),{domain:this.cookiesDomain,cookie:!0})}},{key:"get",value:function(){var t=o.get("fullfill_ref",{domain:this.cookiesDomain},!0);if(!t)return null;var r=t.split(""),n=r[0],a=r[1],i=r[2],c=l.parse(this.tracert.refUrl),f=l.parse(n);return"object"!==e(c)||"object"!==e(f)?null:c.host===f.host?{fullUrl:n,refSpm:a,metaSpmId:i}:null}}])&&r(f.prototype,u),s&&r(f,s),t}();return function(t,e){var r=t,n=new f(r);return r.set({fullfillRef:n}),e(),r}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginTimeOnPage=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t,e){for(var n=0;e.length>n;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var n=t.addEvent,i=t.storage,s=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.pause=function(t){t.target===window&&(n.paused=!0,n._time_consumed+=Date.now()-n._start_timestamp)},this.resume=function(){n.paused&&(n._start_timestamp=Date.now())},this.cache=function(){var t=location.href,e=n.gettimeConsuming();i.set("residual","".concat(encodeURIComponent(t),"|").concat(e))},this._tracert_inst=e,this.paused=!1,this.start(),this.bindEventListeners()}var s,a,r;return s=t,(a=[{key:"start",value:function(){this._start_timestamp=Date.now(),this._time_consumed=0,this.lastClickEle=null,this.lastClickText=""}},{key:"bindEventListeners",value:function(){n("blur",window,this.pause),n("focus",window,this.resume),n("beforeunload",window,this.cache)}},{key:"gettimeConsuming",value:function(){return this.paused?this._time_consumed:this._time_consumed+(Date.now()-this._start_timestamp)}},{key:"getTime",value:function(){var t=i.get("residual",{},!0);if(!t)return null;var e=t.split("|"),n=e[0],s=e[1];try{if(decodeURIComponent(n)===this._tracert_inst.refUrl)return s}catch(t){return null}return null}}])&&e(s.prototype,a),r&&e(s,r),t}();return function(t,e){var n=t;n.before("logPv",(function(t){var e,i=n.timeConsuming.getTime();i&&(t._consume=i),t._title=(e=document.title).length>20?"".concat(e.substring(0,10)).concat(e.substring(e.length-10),"|").concat(e.length-20):e,n.timeConsuming.cache(),n.timeConsuming.start()}));var i=new s(n);return n.set({timeConsuming:i}),e(),n}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertPluginLayout=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;t.length>n;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var i=e.addEvent,o=e.storage;function a(e){return e.length>30?e.substr(0,30):e}function c(e){return e===document.body?"body":e.className?".".concat(a(e.className)):a(e.nodeName.toLowerCase())}function f(e){var t;e=e||[];for(var n=0;e.length>n;n++){var r=e[n];r.isLeaf||(r.children&&!(r=f(r.children))||t&&t.area>=r.area||(t=r))}return t}function u(e){e=e||[];for(var t,n,r,i=[],o=0;e.length>o;o++)n=void 0,r=void 0,n=(t=e[o]).offsetWidth,r=t.offsetHeight,"none"!==t.style.display&&Math.min(n,r)>=20&&Math.max(n,r)>=200&&t.children&&t.children.length>0&&i.push(e[o]);return i}function l(e){for(var t=e.node;;){var n=u(t.children),r=n.length;if(r>1)return n.map((function(e){return{node:e,area:e.offsetWidth*e.offsetHeight}}));if(1!==r)return null;t=n[0]}}function h(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=document.body,n=[{node:t,area:t.offsetWidth*t.offsetHeight}],r=1;;){var i=f(n);if(!i)break;var o=l(i);if(o?r-1+o.length>e?(i.children=o.splice(0,e-r+1),r=e):(i.children=o,r+=o.length-1):i.isLeaf=!0,r>=e)break}return n}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=t||[];return e.forEach((function(e){var t="".concat(n,"").concat(c(e.node));r.push(t),e&&e.children&&s(e.children,r,n+1)})),t?null:r.join("")}var d=function(){function e(n){var r=this;t(this,e),this.tracert=n,n.before("logPv",(function(e){var t=r.get();t&&(e._layout=t)})),this.cache(),i("click",document.body,(function(){r.cache()})),i("unload",window,(function(){r.cache()}))}return r(e,[{key:"getLayout",value:function(){return h(1/0)}},{key:"cache",value:function(){if(!this.cached){var e=h();o.set("layout","".concat(location.href,"|").concat(s(e))),this.cached=!0}}},{key:"get",value:function(){this.cached=void 0;var e=o.get("layout",{},!0);if(!e)return null;var t=e.split("|");return t[0]===this.tracert.refUrl?t[1]:null}}]),e}(),v=e.addEvent,g=e.storage,y=function(){function e(n){var r=this;t(this,e),this.tracert=n,this.tracert.before("logPv",(function(e){var t=r.get();t&&(e._clickReferer=t)})),v("click",document.body,(function(e){r.cache(e.target)}))}return r(e,[{key:"cache",value:function(e){var t=this.getText(e),n=this.getSectionHead(e),r="";n&&(r=this.getSectionTitle(n)),g.set("clickReferer","".concat(location.href,"").concat(this.format(t),"").concat(this.format(r)))}},{key:"get",value:function(){var e=g.get("clickReferer",{},!0);if(!e)return null;var t=e.split(""),n=t[2];return t[0]===this.tracert.refUrl?"".concat(t[1],"").concat(n):null}},{key:"getSectionTitle",value:function(e){for(;e&&e.children&&e.children.length;)e=[].slice.call(e.children).sort((function(e,t){return 24>e.offsetWidth?1:e.offsetLeft-t.offsetLeft}))[0];return this.getText(e)}},{key:"getSectionHead",value:function(e){for(;e.parentNode;){var t=e,n=e=e.parentNode,r=n.offsetWidth;if(r>=200&&r<document.body.offsetWidth){var i=n.children;if(i&&i.length){var o=i.length;if(o>=2&&3>=o&&i[0]!==t){var a=i[0],c=a.offsetWidth,f=a.offsetHeight;if(!(200>c||.9*r>c||14>f||f>60))return a}}}}return null}},{key:"getText",value:function(e){if(this.isTooManyChildren(e,3))return"";var t=e.innerText;if(!t){var n=e.parentNode;this.isTooManyChildren(n,3)||(t=n.innerText)}return t}},{key:"format",value:function(e){if(!e)return"";var t=e.length;return t>20?"...".concat(e.substr(t-20)):e}},{key:"isTooManyChildren",value:function(e,t){var n=0,r=function(e){var i=e.children;if(i){var o=i.length;if(t>=(n+=o)&&o)for(var a=0;o>a;a++)if(r(i[a]),n>t)return}};return r(e),n>t}}]),e}();return function(e,t){var n=e,r=new d(n),i=new y(n);return n.set({_layout:r,clickReferer:i}),t(),n}}));
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).tracertPluginAutoLogPv=e(t.tracertUtil)}(this,(function(t){"use strict";function e(t,e){for(var r=0;e.length>r;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=t.url;function n(){return document.body&&document.body.innerText&&document.body.innerText.length||0}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tracert=e,this.curUrl=e.get("fullURL");var i=this.curUrlObj=r.parse(this.curUrl);this.curDocLen=n();var s=i.hash,a=this.isAnchor(s);a||(i.hash=this.cleanHash(s)),this.tracert.call("set",{url:a?this.curUrl.split(/\?|#/)[0]:i.format()}),this.tracert.call("addSideEffects",this.stop.bind(this)),this.start()}var i,s,a;return i=t,(s=[{key:"start",value:function(){var t=this;this.interval=setTimeout((function(){t.check(),t.start()}),500)}},{key:"stop",value:function(){console.log("stop"),clearTimeout(this.interval),this.interval=void 0}},{key:"check",value:function(){var t=window.location.href,e=this.diff(t);e&&(this.tracert.call("set",{refUrl:this.curUrl,referSPM:"".concat(this.tracert.spmAPos,".").concat(this.tracert.spmBPos),url:e.isHashSinglePage?e.format():t.split(/\?|#/)[0],fullURL:t}),this.tracert.call("logPv",e.isHashSinglePage?{}:{_nohash:1})),this.curUrl=t,this.curUrlObj=e||r.parse(t),this.curDocLen=n()}},{key:"diff",value:function(t){if(t===this.curUrl)return!1;var e=r.parse(t),n=e.hash,i=this.curUrlObj;return e.path===i.path&&function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return JSON.stringify(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})===JSON.stringify(t)}(e.query,i.query)?n!==i.hash&&!this.isAnchor(n)&&(e.isHashSinglePage=!0,e.hash=this.cleanHash(e.hash),e):e}},{key:"isAnchor",value:function(t){return!(!t||"#"===t)&&"/"!==(t=t.substr(1))[0]&&document.getElementById(decodeURI(t))&&5>Math.abs(this.curDocLen-n())}},{key:"cleanHash",value:function(t){if(!t)return t;var e=t.indexOf("?");return-1!==e&&(t=t.substr(0,e)),t}}])&&e(i.prototype,s),a&&e(i,a),t}();return function(t,e){var r=t,n=new i(r);return r.set({monitor:n}),r.before("set",(function(t){if(t&&t.pathName&&r.spmAPos){n.stop();var e=t.pathName,i=r.pathName;r._spmId&&(r._refSpm=r._spmId),r.fullURL=location.href,r._spmId="".concat(r.spmAPos,".").concat(encodeURIComponent(e)),i&&(r.refUrl=r.url,r.referSPM="".concat(r.spmAPos,".").concat(r.spmBPos),r.url=location.href.split(/\?|#|;jsessionid=/)[0],r.spmBPos=t.spmBPos||r.spmBPos,r.autoLogPv&&r.call("logPv"))}})),e(),r}}));
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@alipay/tracert-util")):"function"==typeof define&&define.dmmma?define(["@alipay/tracert-util"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).tracertWeb=t(e.tracertUtil)}(this,(function(e){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function n(e){for(var n=1;arguments.length>n;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function i(e,t){for(var n=0;t.length>n;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);t>n;n++)i[n]=e[n];return i}var s,c,f,u,d=window,h="nameStorage:",l=/^([^=]+)(?:=(.*))?$/,p=encodeURIComponent,g=decodeURIComponent,m={},v={};function y(){var e,t=[],n=!0;for(var i in m)m.hasOwnProperty(i)&&(n=!1,e=m[i]||"",t.push(p(i)+"="+p(e)));d.name=n?s:h+p(s)+"?"+t.join("&")}!function(e){if(e&&0===e.indexOf(h)){var t=e.split(/[:?]/);t.shift(),s=g(t.shift())||"";for(var n,i,r,o=t.join("").split("&"),a=0,c=o.length;c>a;a++)(n=o[a].match(l))&&n[1]&&(i=g(n[1]),r=g(n[2])||"",m[i]=r)}else s=e||""}(d.name),v.setItem=function(e,t){e&&void 0!==t&&(m[e]=t+"",y())},v.getItem=function(e){return m.hasOwnProperty(e)?m[e]:null},v.removeItem=function(e){m.hasOwnProperty(e)&&(m[e]=null,delete m[e],y())},v.clear=function(){m={},y()},v.valueOf=function(){return m},v.toString=function(){var e=d.name;return 0===e.indexOf(h)?e:h+e},f="beforeunload",u=function(){y()},(c=d)&&(c.addEventListener?c.addEventListener(f,u,!1):c.attachEvent&&c.attachEvent("on"+f,(function(e){u.call(c,e)}))),d.nameStorage=v;var I=v,_=e.load,b=e.CrossIframe;function S(e,t){e.postMessage(JSON.stringify(t),"*")}var w=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframe=null,this.iframeLoaded=!1,this.userId=null,this.pending=!1,this.queue=[],this.cachedQuery=[],_((function(){window.addEventListener("message",(function(e){return t.receive(e)}),!1),t.iframe=b.initIframe()}))}var t,n,r;return t=e,(n=[{key:"receive",value:function(e){var t;if(e.data){try{t=JSON.parse(e.data)}catch(e){return}if(t.type)switch(t.type){case"getStorage":for(this.pending=!1;this.queue.length;)(0,this.queue[0])(t),this.queue.shift();break;case"iframOnload":this.iframeOnLoad()}}}},{key:"iframeOnLoad",value:function(){this.iframeLoaded=!0,this.executeCachedQuery()}},{key:"executeCachedQuery",value:function(){if(this.cachedQuery.length)for(var e=0;this.cachedQuery.length>e;e++){var t=o(this.cachedQuery[e]),n=t[0],i=t.slice(1);this[n].apply(this,i)}}},{key:"set",value:function(e,t,n){this.iframeLoaded?(n&&"function"==typeof n&&this.queue.push(n),S(this.iframe.contentWindow,{type:"storage",action:"set",key:e,value:t})):this.cachedQuery.push(["set",e,t,n])}},{key:"get",value:function(e,t){var n=this.iframe.contentWindow;this.iframeLoaded?(t&&"function"==typeof t&&this.queue.push(t),this.pending||(S(n,{type:"storage",action:"get",key:e}),this.pending=!0)):this.cachedQuery.push(["get",e,t])}}])&&i(t.prototype,n),r&&i(t,r),e}(),P=e.isWechat,O="TRACERT_REF_",j={_guid:function(){return e.uuid()},_initCrossStorage:function(e){P()||(e._crossStorage=new w)},_initClientId:function(e){var t=window.localStorage,n=e.sessionIdKey;t&&(t[n]||(t[n]="".concat(this._guid(),"_").concat(Date.now())),e.set({clientId:t[n]}),e._crossStorage&&e._crossStorage.get(n,(function(i){var r=i.value;if(n===i.key){var o=r||t[n];e.set({clientId:o}),r||e._crossStorage.set(n,o),t[n]!==o&&(t[n]=o)}})))},_initChInfo:function(t){if(!t.chInfo){var n=e.getValue("chInfo")||e.getValue("chinfo");n&&t.set({chInfo:n})}},_initVerify:function(t){var n=e.getValue("tracertTaskId"),i=e.getValue("tracertVerifyServer");n&&t.set({taskId:n}),i&&t.set({verifyServer:i})},_initPageId:function(e){if(!e.get("pageId")){var t="".concat(e.spmAPos,".").concat(e.spmBPos,"_").concat(this._guid(),"_").concat(Date.now());e.set({pageId:t})}},_initFromUrlOrStorage:function(t,n){for(var i=0;n.length>i;i++){var r=n[i],o=e.getValue(r)||I.getItem("".concat(O).concat(r));if(o){var a={};a[r]=o,t.set(a)}}},_initRefs:function(e){if(this._initFromUrlOrStorage(e,["referSPM"]),!e.ignoreNameStorage){var t=e._isMain;void 0!==t&&t&&(window.onunload=function(){var t=e.spmAPos&&e.spmBPos?[e.spmAPos,e.spmBPos].join("."):"";console.log("webMain",e._isMain),t&&I.setItem("".concat(O,"referSPM"),t)})}}},k=e.objectAssign,C={eventType:"click",fullURL:location.href,server:"https://collect.alipay.com/dwcookie",openSendBeacon:!1,refUrl:document.referrer||"-",seedIdCfg:{pageSeedId:"10012",clkSeedId:"10032",expoSeedId:"10022",perfSeedId:"10074",exceptionSeedId:"102022"},v:"web",verifyServer:"https://log.alipay.com/realTimeNonNativeLogCheck/uploadLog.json",init:function(){this._calledInited||(j._initCrossStorage(this),j._initClientId(this),j._initChInfo(this),j._initPageId(this),j._initRefs(this),j._initVerify(this),this._calledInited=!0)},_logPv:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this.spmAPos&&this.spmBPos?[this.spmAPos,this.spmBPos].join("."):"",r=document.getElementsByTagName("meta")["extra-page-spm"],o=[null].concat(r&&r.content?r.content.split(","):[]);o.forEach((function(r){e.call("remoteLog",{seedId:e.seedIdCfg.pageSeedId,spmId:i,extraPageId:r,param4:n({},t)})}))},remoteLog:function(e,t){this.init();var n=this._packFinalData(e,t);this._send(n)},_packFinalData:function(t){var n=t.spmId,i=t.seedId,r=t.param4,o=t.extraPageId,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(r,this.mdata||{});var s=r.__sid||j._guid(),c=a.bizType;if(delete r.__sid,r.spmId=n,i!==this.seedIdCfg.pageSeedId&&i!==this.seedIdCfg.perfSeedId){var f=this.spmAPos,u=this.spmBPos,d=n.split("."),h=d.length;switch(h){case 1:if(""===n)break;r.spmId=[f,u,n].join(".");break;case 2:r.spmId=[f,u,n].join(".")}}var l=this.refSpm||this.referSPM||"";r.ref=this.refUrl,r.referSPM=l,this.chInfo&&(r.chInfo=this.chInfo),r.fullURL=this.fullURL,r.source_appid=this.spmAPos,this._spmId&&(r._spmId=this._spmId),this._refSpm&&(r._refSpm=this._refSpm),this.platformType&&(r.mPlatformType=this.platformType);var p=e.getUserId(this);p&&(r.__BUC_ID=p);var g=this.userType;if(!g)switch(g="3",this.spmAPos){case"a385":case"a369":g="2";break;case"a316":g="1"}r.__ut=g;var m=e.getUserId(this);r.clientID=this.clientId,r=e.processParam4(r);for(var v=["D-AE",e.getNewDate(),this.clientID,"","2","",s,m,1e3,i,c||this.bizType,this.logLevel,o||this.pageId,"","","","","","","","","","","","","".concat(window.innerWidth||"","x").concat(window.innerHeight,"x").concat(window.devicePixelRatio),"","","",navigator.userAgent,"","","",e.objToStr(this.sysInfo),"","",e.objToStr(r)],y=0;v.length>y;y++)"string"==typeof v[y]&&(v[y]=v[y].replace(/,/g,"%2C"));return v},_send:function(t){e.request({tracert:this,type:e.requestTypeEnum.http,data:t})},send:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"10032",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._runBeforeFns("send",t),this.remoteLog({spmId:n||"".concat(this.spmAPos,".").concat(this.spmBPos),seedId:e,param4:t},i)}};return function(e,t){var i=e;return i.set(n({},C)),t(),i}}));
 'use strict'; var win = window; if (!win.Tracert || win.Tracert._isInit || win.Tracert._isRenderInit) { var Tracert = new win.tracertCore({ _isMain: true }); Tracert.set({ userType: '2', spmAPos: 'a385', spmBPos: 'b4693' }); Tracert.set(win._to || {}); Tracert.setSysInfo({ v: '712af' }); var plugins = [ win.tracertWeb, win.tracertMonitor, win.tracertPluginPerformance, win.tracertPluginClickAndExpo, win.tracertPluginClientSession, win.tracertPluginFullfillRef, win.tracertPluginTimeOnPage, win.tracertPluginLayout, win.tracertPluginAutoLogPv ]; Tracert.loadPlugins(plugins); win.Tracert = Tracert; } 